<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>13 Time-series analysis in R-INLA | Introduction to spatial-temporal data anlysis using R</title>
  <meta name="description" content="13 Time-series analysis in R-INLA | Introduction to spatial-temporal data anlysis using R" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="13 Time-series analysis in R-INLA | Introduction to spatial-temporal data anlysis using R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13 Time-series analysis in R-INLA | Introduction to spatial-temporal data anlysis using R" />
  
  
  

<meta name="author" content="Tsubasa Yamaguchi" />


<meta name="date" content="2023-09-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Chapter13.html"/>
<link rel="next" href="sessioninfo.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.27/datatables.js"></script>
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="custom_style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>本稿の目的</a></li>
<li class="chapter" data-level="" data-path="Chapter0.html"><a href="Chapter0.html"><i class="fa fa-check"></i>0. パッケージの読み込み</a></li>
<li class="chapter" data-level="1" data-path="Chapter2.html"><a href="Chapter2.html"><i class="fa fa-check"></i><b>1</b> Recognizing statistical dependency</a>
<ul>
<li class="chapter" data-level="1.1" data-path="Chapter2.html"><a href="Chapter2.html#pseudoreplication"><i class="fa fa-check"></i><b>1.1</b> Pseudoreplication</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="Chapter2.html"><a href="Chapter2.html#疑似反復とは"><i class="fa fa-check"></i><b>1.1.1</b> 疑似反復とは</a></li>
<li class="chapter" data-level="1.1.2" data-path="Chapter2.html"><a href="Chapter2.html#時空間的な疑似反復"><i class="fa fa-check"></i><b>1.1.2</b> 時空間的な疑似反復</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="Chapter2.html"><a href="Chapter2.html#s1-2"><i class="fa fa-check"></i><b>1.2</b> Linear regression applied to spatial data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="Chapter2.html"><a href="Chapter2.html#visualization"><i class="fa fa-check"></i><b>1.2.1</b> Visualization</a></li>
<li class="chapter" data-level="1.2.2" data-path="Chapter2.html"><a href="Chapter2.html#dependency"><i class="fa fa-check"></i><b>1.2.2</b> Dependency</a></li>
<li class="chapter" data-level="1.2.3" data-path="Chapter2.html"><a href="Chapter2.html#fit-the-model"><i class="fa fa-check"></i><b>1.2.3</b> Fit the model</a></li>
<li class="chapter" data-level="1.2.4" data-path="Chapter2.html"><a href="Chapter2.html#model-validation"><i class="fa fa-check"></i><b>1.2.4</b> Model validation</a>
<ul>
<li class="chapter" data-level="1.2.4.1" data-path="Chapter2.html"><a href="Chapter2.html#check-homogeinity-and-model-misfit"><i class="fa fa-check"></i><b>1.2.4.1</b> Check homogeinity and model misfit</a></li>
</ul></li>
<li class="chapter" data-level="1.2.5" data-path="Chapter2.html"><a href="Chapter2.html#check-spatial-dependence"><i class="fa fa-check"></i><b>1.2.5</b> Check spatial dependence</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="Chapter2.html"><a href="Chapter2.html#s2-2"><i class="fa fa-check"></i><b>1.3</b> GAM applied to temporal data</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="Chapter2.html"><a href="Chapter2.html#subnivium-temperature-data"><i class="fa fa-check"></i><b>1.3.1</b> Subnivium temperature data</a></li>
<li class="chapter" data-level="1.3.2" data-path="Chapter2.html"><a href="Chapter2.html#sources-of-dependency"><i class="fa fa-check"></i><b>1.3.2</b> Sources of dependency</a></li>
<li class="chapter" data-level="1.3.3" data-path="Chapter2.html"><a href="Chapter2.html#the-model"><i class="fa fa-check"></i><b>1.3.3</b> The model</a></li>
<li class="chapter" data-level="1.3.4" data-path="Chapter2.html"><a href="Chapter2.html#model-validation-1"><i class="fa fa-check"></i><b>1.3.4</b> Model validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Chapter3.html"><a href="Chapter3.html"><i class="fa fa-check"></i><b>2</b> Time series and GLS</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Chapter3.html"><a href="Chapter3.html#ospreys"><i class="fa fa-check"></i><b>2.1</b> Ospreys</a></li>
<li class="chapter" data-level="2.2" data-path="Chapter3.html"><a href="Chapter3.html#covariance-and-correlation-coefficients"><i class="fa fa-check"></i><b>2.2</b> Covariance and correlation coefficients</a></li>
<li class="chapter" data-level="2.3" data-path="Chapter3.html"><a href="Chapter3.html#linear-regression-models"><i class="fa fa-check"></i><b>2.3</b> Linear regression models</a></li>
<li class="chapter" data-level="2.4" data-path="Chapter3.html"><a href="Chapter3.html#focusing-on-the-residual-covariance-matrix"><i class="fa fa-check"></i><b>2.4</b> Focusing on the residual covariance matrix</a></li>
<li class="chapter" data-level="2.5" data-path="Chapter3.html"><a href="Chapter3.html#dependency-and-the-covariance-matrix"><i class="fa fa-check"></i><b>2.5</b> Dependency and the covariance matrix</a></li>
<li class="chapter" data-level="2.6" data-path="Chapter3.html"><a href="Chapter3.html#dealing-with-temporal-dependency"><i class="fa fa-check"></i><b>2.6</b> Dealing with temporal dependency</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="Chapter3.html"><a href="Chapter3.html#adelie-penguins"><i class="fa fa-check"></i><b>2.6.1</b> Adelie penguins</a></li>
<li class="chapter" data-level="2.6.2" data-path="Chapter3.html"><a href="Chapter3.html#do-we-have-dependency"><i class="fa fa-check"></i><b>2.6.2</b> Do we have dependency?</a></li>
<li class="chapter" data-level="2.6.3" data-path="Chapter3.html"><a href="Chapter3.html#formulation-of-the-linear-regression-model"><i class="fa fa-check"></i><b>2.6.3</b> Formulation of the linear regression model</a></li>
<li class="chapter" data-level="2.6.4" data-path="Chapter3.html"><a href="Chapter3.html#application-of-the-linear-regression-model"><i class="fa fa-check"></i><b>2.6.4</b> Application of the linear regression model</a></li>
<li class="chapter" data-level="2.6.5" data-path="Chapter3.html"><a href="Chapter3.html#formulation-of-the-gls-model"><i class="fa fa-check"></i><b>2.6.5</b> Formulation of the GLS model</a></li>
<li class="chapter" data-level="2.6.6" data-path="Chapter3.html"><a href="Chapter3.html#implementation-using-the-gls-function"><i class="fa fa-check"></i><b>2.6.6</b> Implementation using the gls function</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="Chapter3.html"><a href="Chapter3.html#multiple-time-series"><i class="fa fa-check"></i><b>2.7</b> Multiple time series</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Chapter4.html"><a href="Chapter4.html"><i class="fa fa-check"></i><b>3</b> Spatial data and GLS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Chapter4.html"><a href="Chapter4.html#variogram-models-for-spatial-dependency"><i class="fa fa-check"></i><b>3.1</b> Variogram models for spatial dependency</a></li>
<li class="chapter" data-level="3.2" data-path="Chapter4.html"><a href="Chapter4.html#application-on-the-irish-ph-data"><i class="fa fa-check"></i><b>3.2</b> Application on the Irish pH data</a></li>
<li class="chapter" data-level="3.3" data-path="Chapter4.html"><a href="Chapter4.html#s4-3"><i class="fa fa-check"></i><b>3.3</b> Matern correlation function</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Chapter5.html"><a href="Chapter5.html"><i class="fa fa-check"></i><b>4</b> Linear mixed-effects models and dependency</a>
<ul>
<li class="chapter" data-level="4.1" data-path="Chapter5.html"><a href="Chapter5.html#white-storks"><i class="fa fa-check"></i><b>4.1</b> White Storks</a></li>
<li class="chapter" data-level="4.2" data-path="Chapter5.html"><a href="Chapter5.html#considering-the-data-wrongly-as-one-way-nested"><i class="fa fa-check"></i><b>4.2</b> Considering the data (wrongly) as one-way nested</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="Chapter5.html"><a href="Chapter5.html#model-formulation"><i class="fa fa-check"></i><b>4.2.1</b> model formulation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="Chapter5.html"><a href="Chapter5.html#fitting-the-one-way-nested-model-using-lmer"><i class="fa fa-check"></i><b>4.3</b> Fitting the one-way nested model using lmer</a></li>
<li class="chapter" data-level="4.4" data-path="Chapter5.html"><a href="Chapter5.html#model-validation-2"><i class="fa fa-check"></i><b>4.4</b> Model validation</a></li>
<li class="chapter" data-level="4.5" data-path="Chapter5.html"><a href="Chapter5.html#sketching-the-fitted-value"><i class="fa fa-check"></i><b>4.5</b> Sketching the fitted value</a></li>
<li class="chapter" data-level="4.6" data-path="Chapter5.html"><a href="Chapter5.html#considering-the-data-correctly-as-two-way-nested"><i class="fa fa-check"></i><b>4.6</b> Considering the data (correctly) as two-way nested</a></li>
<li class="chapter" data-level="4.7" data-path="Chapter5.html"><a href="Chapter5.html#differences-with-the-ar1-process-approach"><i class="fa fa-check"></i><b>4.7</b> Differences with the AR1 process approach</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Chapter6.html"><a href="Chapter6.html"><i class="fa fa-check"></i><b>5</b> Modelling space explicitly</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Chapter6.html"><a href="Chapter6.html#model-formulation-1"><i class="fa fa-check"></i><b>5.1</b> Model formulation</a></li>
<li class="chapter" data-level="5.2" data-path="Chapter6.html"><a href="Chapter6.html#s6-2"><i class="fa fa-check"></i><b>5.2</b> Covariance matrix of the spatial random effect</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="Chapter6.html"><a href="Chapter6.html#simulation-study"><i class="fa fa-check"></i><b>5.2.1</b> Simulation study</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="Chapter6.html"><a href="Chapter6.html#spatial-temporal-correlation"><i class="fa fa-check"></i><b>5.3</b> Spatial-temporal correlation</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="Chapter6.html"><a href="Chapter6.html#simulation-study-continued"><i class="fa fa-check"></i><b>5.3.1</b> Simulation study (continued)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Chapter7.html"><a href="Chapter7.html"><i class="fa fa-check"></i><b>6</b> Introduction to Bayesian statistics</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Chapter7.html"><a href="Chapter7.html#why-go-bayesian"><i class="fa fa-check"></i><b>6.1</b> Why go Bayesian?</a></li>
<li class="chapter" data-level="6.2" data-path="Chapter7.html"><a href="Chapter7.html#s7-2"><i class="fa fa-check"></i><b>6.2</b> General probability rules</a></li>
<li class="chapter" data-level="6.3" data-path="Chapter7.html"><a href="Chapter7.html#s7-3"><i class="fa fa-check"></i><b>6.3</b> The mean of a distribution</a></li>
<li class="chapter" data-level="6.4" data-path="Chapter7.html"><a href="Chapter7.html#bayes-theorem-again"><i class="fa fa-check"></i><b>6.4</b> Bayes theorem again</a></li>
<li class="chapter" data-level="6.5" data-path="Chapter7.html"><a href="Chapter7.html#s7-5"><i class="fa fa-check"></i><b>6.5</b> Conjugate priors</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="Chapter7.html"><a href="Chapter7.html#likelihood-function"><i class="fa fa-check"></i><b>6.5.1</b> Likelihood function</a></li>
<li class="chapter" data-level="6.5.2" data-path="Chapter7.html"><a href="Chapter7.html#priors"><i class="fa fa-check"></i><b>6.5.2</b> Priors</a></li>
<li class="chapter" data-level="6.5.3" data-path="Chapter7.html"><a href="Chapter7.html#posterior-distribution"><i class="fa fa-check"></i><b>6.5.3</b> Posterior distribution</a></li>
<li class="chapter" data-level="6.5.4" data-path="Chapter7.html"><a href="Chapter7.html#diffuse-prior"><i class="fa fa-check"></i><b>6.5.4</b> Diffuse prior</a></li>
<li class="chapter" data-level="6.5.5" data-path="Chapter7.html"><a href="Chapter7.html#informative-prior"><i class="fa fa-check"></i><b>6.5.5</b> Informative prior</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="Chapter7.html"><a href="Chapter7.html#markov-chain-monte-carlo-simulation"><i class="fa fa-check"></i><b>6.6</b> Markov chain Monte Carlo simulation</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="Chapter7.html"><a href="Chapter7.html#underlying-idea"><i class="fa fa-check"></i><b>6.6.1</b> underlying idea</a></li>
<li class="chapter" data-level="6.6.2" data-path="Chapter7.html"><a href="Chapter7.html#simple-example-of-mcmc-algorithm"><i class="fa fa-check"></i><b>6.6.2</b> Simple example of MCMC algorithm</a></li>
<li class="chapter" data-level="6.6.3" data-path="Chapter7.html"><a href="Chapter7.html#methods-in-mcmc"><i class="fa fa-check"></i><b>6.6.3</b> Methods in MCMC</a></li>
<li class="chapter" data-level="6.6.4" data-path="Chapter7.html"><a href="Chapter7.html#flowchart-for-running-a-model-in-stan"><i class="fa fa-check"></i><b>6.6.4</b> Flowchart for running a model in Stan</a>
<ul>
<li class="chapter" data-level="6.6.4.1" data-path="Chapter7.html"><a href="Chapter7.html#preparing-the-data-for-stan"><i class="fa fa-check"></i><b>6.6.4.1</b> Preparing the data for Stan</a></li>
<li class="chapter" data-level="6.6.4.2" data-path="Chapter7.html"><a href="Chapter7.html#decide-model-formulation-and-priors"><i class="fa fa-check"></i><b>6.6.4.2</b> Decide model formulation and priors</a></li>
<li class="chapter" data-level="6.6.4.3" data-path="Chapter7.html"><a href="Chapter7.html#preparing-stan-file"><i class="fa fa-check"></i><b>6.6.4.3</b> Preparing stan file</a></li>
<li class="chapter" data-level="6.6.4.4" data-path="Chapter7.html"><a href="Chapter7.html#initial-values"><i class="fa fa-check"></i><b>6.6.4.4</b> Initial values</a></li>
</ul></li>
<li class="chapter" data-level="6.6.5" data-path="Chapter7.html"><a href="Chapter7.html#running-model-in-stan"><i class="fa fa-check"></i><b>6.6.5</b> Running model in Stan</a></li>
<li class="chapter" data-level="6.6.6" data-path="Chapter7.html"><a href="Chapter7.html#assess-mixing"><i class="fa fa-check"></i><b>6.6.6</b> Assess mixing</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="Chapter7.html"><a href="Chapter7.html#integrated-nested-laplace-approximation"><i class="fa fa-check"></i><b>6.7</b> Integrated nested Laplace approximation</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="Chapter7.html"><a href="Chapter7.html#joint-posterior-distribution"><i class="fa fa-check"></i><b>6.7.1</b> Joint posterior distribution</a></li>
<li class="chapter" data-level="6.7.2" data-path="Chapter7.html"><a href="Chapter7.html#marginal-distributions"><i class="fa fa-check"></i><b>6.7.2</b> Marginal distributions</a></li>
<li class="chapter" data-level="6.7.3" data-path="Chapter7.html"><a href="Chapter7.html#back-to-high-school"><i class="fa fa-check"></i><b>6.7.3</b> Back to high school</a></li>
<li class="chapter" data-level="6.7.4" data-path="Chapter7.html"><a href="Chapter7.html#inla"><i class="fa fa-check"></i><b>6.7.4</b> INLA</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="Chapter7.html"><a href="Chapter7.html#examples-using-r-inla"><i class="fa fa-check"></i><b>6.8</b> Examples using R-INLA</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="Chapter7.html"><a href="Chapter7.html#s7-8-1"><i class="fa fa-check"></i><b>6.8.1</b> Posterior summary</a></li>
<li class="chapter" data-level="6.8.2" data-path="Chapter7.html"><a href="Chapter7.html#posterior-marginal-distributions"><i class="fa fa-check"></i><b>6.8.2</b> Posterior marginal distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="Chapter7.html"><a href="Chapter7.html#追記"><i class="fa fa-check"></i><b>6.9</b> 追記</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Chapter8.html"><a href="Chapter8.html"><i class="fa fa-check"></i><b>7</b> Multiple linear regression in R-INLA</a>
<ul>
<li class="chapter" data-level="7.1" data-path="Chapter8.html"><a href="Chapter8.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="Chapter8.html"><a href="Chapter8.html#data-exploration"><i class="fa fa-check"></i><b>7.2</b> Data exploration</a></li>
<li class="chapter" data-level="7.3" data-path="Chapter8.html"><a href="Chapter8.html#linear-regression-result"><i class="fa fa-check"></i><b>7.3</b> Linear regression result</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="Chapter8.html"><a href="Chapter8.html#executing-the-model-in-rinla"><i class="fa fa-check"></i><b>7.3.1</b> Executing the model in R=INLA</a></li>
<li class="chapter" data-level="7.3.2" data-path="Chapter8.html"><a href="Chapter8.html#output-for-betas"><i class="fa fa-check"></i><b>7.3.2</b> Output for betas</a>
<ul>
<li class="chapter" data-level="7.3.2.1" data-path="Chapter8.html"><a href="Chapter8.html#numerical-output-for-the-betas"><i class="fa fa-check"></i><b>7.3.2.1</b> Numerical output for the betas</a></li>
<li class="chapter" data-level="7.3.2.2" data-path="Chapter8.html"><a href="Chapter8.html#graphical-output-for-the-betas"><i class="fa fa-check"></i><b>7.3.2.2</b> Graphical output for the betas</a></li>
</ul></li>
<li class="chapter" data-level="7.3.3" data-path="Chapter8.html"><a href="Chapter8.html#output-for-hyperparameters"><i class="fa fa-check"></i><b>7.3.3</b> Output for hyperparameters</a>
<ul>
<li class="chapter" data-level="7.3.3.1" data-path="Chapter8.html"><a href="Chapter8.html#numerical-output-for-hyper-parameters"><i class="fa fa-check"></i><b>7.3.3.1</b> Numerical output for hyper parameters</a></li>
<li class="chapter" data-level="7.3.3.2" data-path="Chapter8.html"><a href="Chapter8.html#graphical-output-for-the-hyperparameters"><i class="fa fa-check"></i><b>7.3.3.2</b> Graphical output for the hyperparameters</a></li>
</ul></li>
<li class="chapter" data-level="7.3.4" data-path="Chapter8.html"><a href="Chapter8.html#fitted-model"><i class="fa fa-check"></i><b>7.3.4</b> Fitted model</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="Chapter8.html"><a href="Chapter8.html#model-validation-3"><i class="fa fa-check"></i><b>7.4</b> Model validation</a></li>
<li class="chapter" data-level="7.5" data-path="Chapter8.html"><a href="Chapter8.html#model-selection"><i class="fa fa-check"></i><b>7.5</b> Model selection</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="Chapter8.html"><a href="Chapter8.html#what-should-we-do"><i class="fa fa-check"></i><b>7.5.1</b> What should we do?</a></li>
<li class="chapter" data-level="7.5.2" data-path="Chapter8.html"><a href="Chapter8.html#usind-the-dic"><i class="fa fa-check"></i><b>7.5.2</b> Usind the DIC</a>
<ul>
<li class="chapter" data-level="7.5.2.1" data-path="Chapter8.html"><a href="Chapter8.html#effective-number-of-parameters"><i class="fa fa-check"></i><b>7.5.2.1</b> Effective number of parameters</a></li>
<li class="chapter" data-level="7.5.2.2" data-path="Chapter8.html"><a href="Chapter8.html#dic-related-output"><i class="fa fa-check"></i><b>7.5.2.2</b> DIC related output</a></li>
<li class="chapter" data-level="7.5.2.3" data-path="Chapter8.html"><a href="Chapter8.html#model-selection-using-dic"><i class="fa fa-check"></i><b>7.5.2.3</b> Model selection using DIC</a></li>
</ul></li>
<li class="chapter" data-level="7.5.3" data-path="Chapter8.html"><a href="Chapter8.html#waic"><i class="fa fa-check"></i><b>7.5.3</b> WAIC</a></li>
<li class="chapter" data-level="7.5.4" data-path="Chapter8.html"><a href="Chapter8.html#out-of-sample-prediction"><i class="fa fa-check"></i><b>7.5.4</b> Out of sample prediction</a></li>
<li class="chapter" data-level="7.5.5" data-path="Chapter8.html"><a href="Chapter8.html#posterior-predictive-check"><i class="fa fa-check"></i><b>7.5.5</b> Posterior predictive check</a>
<ul>
<li class="chapter" data-level="7.5.5.1" data-path="Chapter8.html"><a href="Chapter8.html#zuur-2017の方法"><i class="fa fa-check"></i><b>7.5.5.1</b> Zuur (2017)の方法</a></li>
<li class="chapter" data-level="7.5.5.2" data-path="Chapter8.html"><a href="Chapter8.html#s8-5-5-2"><i class="fa fa-check"></i><b>7.5.5.2</b> 正しい方法</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="Chapter8.html"><a href="Chapter8.html#s8-6"><i class="fa fa-check"></i><b>7.6</b> Visualizing the model</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Chapter9.html"><a href="Chapter9.html"><i class="fa fa-check"></i><b>8</b> Mixed effects modelling in R-INLA to analysis otolith data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="Chapter9.html"><a href="Chapter9.html#otoliths-in-plaice"><i class="fa fa-check"></i><b>8.1</b> Otoliths in plaice</a></li>
<li class="chapter" data-level="8.2" data-path="Chapter9.html"><a href="Chapter9.html#model-formulation-2"><i class="fa fa-check"></i><b>8.2</b> Model formulation</a></li>
<li class="chapter" data-level="8.3" data-path="Chapter9.html"><a href="Chapter9.html#dependency-1"><i class="fa fa-check"></i><b>8.3</b> Dependency</a></li>
<li class="chapter" data-level="8.4" data-path="Chapter9.html"><a href="Chapter9.html#data-exploration-1"><i class="fa fa-check"></i><b>8.4</b> Data exploration</a></li>
<li class="chapter" data-level="8.5" data-path="Chapter9.html"><a href="Chapter9.html#running-the-model-in-r-inla"><i class="fa fa-check"></i><b>8.5</b> Running the model in R-INLA</a></li>
<li class="chapter" data-level="8.6" data-path="Chapter9.html"><a href="Chapter9.html#model-validation-4"><i class="fa fa-check"></i><b>8.6</b> Model validation</a></li>
<li class="chapter" data-level="8.7" data-path="Chapter9.html"><a href="Chapter9.html#model-selection-1"><i class="fa fa-check"></i><b>8.7</b> Model selection</a></li>
<li class="chapter" data-level="8.8" data-path="Chapter9.html"><a href="Chapter9.html#model-interpretation"><i class="fa fa-check"></i><b>8.8</b> Model interpretation</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="Chapter9.html"><a href="Chapter9.html#option-1-for-prediction-adding-extra-data"><i class="fa fa-check"></i><b>8.8.1</b> Option 1 for prediction: Adding extra data</a></li>
<li class="chapter" data-level="8.8.2" data-path="Chapter9.html"><a href="Chapter9.html#s9-8-2"><i class="fa fa-check"></i><b>8.8.2</b> Option 2 for prediction: Using the <code>inla.make.lincombs</code></a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="Chapter9.html"><a href="Chapter9.html#multiple-random-effects"><i class="fa fa-check"></i><b>8.9</b> Multiple random effects</a></li>
<li class="chapter" data-level="8.10" data-path="Chapter9.html"><a href="Chapter9.html#changin-prior-of-fixed-parameters"><i class="fa fa-check"></i><b>8.10</b> Changin prior of fixed parameters</a></li>
<li class="chapter" data-level="8.11" data-path="Chapter9.html"><a href="Chapter9.html#changing-priors-of-hyperparameters"><i class="fa fa-check"></i><b>8.11</b> Changing priors of hyperparameters</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Chapter10.html"><a href="Chapter10.html"><i class="fa fa-check"></i><b>9</b> Poisson, negative binomial, binomial and g amma GLMs in R-INLA</a>
<ul>
<li class="chapter" data-level="9.1" data-path="Chapter10.html"><a href="Chapter10.html#poisson-and-negative-binomial-glms-in-r-inla"><i class="fa fa-check"></i><b>9.1</b> Poisson and negative binomial GLMs in R-INLA</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="Chapter10.html"><a href="Chapter10.html#introduction-1"><i class="fa fa-check"></i><b>9.1.1</b> Introduction</a></li>
<li class="chapter" data-level="9.1.2" data-path="Chapter10.html"><a href="Chapter10.html#data-exploration-2"><i class="fa fa-check"></i><b>9.1.2</b> Data exploration</a></li>
<li class="chapter" data-level="9.1.3" data-path="Chapter10.html"><a href="Chapter10.html#poisson-glm-an-r-inla"><i class="fa fa-check"></i><b>9.1.3</b> Poisson GLM an R-INLA</a>
<ul>
<li class="chapter" data-level="9.1.3.1" data-path="Chapter10.html"><a href="Chapter10.html#s10-1-3-1"><i class="fa fa-check"></i><b>9.1.3.1</b> Checking overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="9.1.4" data-path="Chapter10.html"><a href="Chapter10.html#negative-binomial-glm-in-r-inla"><i class="fa fa-check"></i><b>9.1.4</b> Negative binomial GLM in R-INLA</a></li>
<li class="chapter" data-level="9.1.5" data-path="Chapter10.html"><a href="Chapter10.html#model-selection-for-the-nb-glm"><i class="fa fa-check"></i><b>9.1.5</b> Model selection for the NB GLM</a></li>
<li class="chapter" data-level="9.1.6" data-path="Chapter10.html"><a href="Chapter10.html#visualization-of-the-nb-glm"><i class="fa fa-check"></i><b>9.1.6</b> Visualization of the NB GLM</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="Chapter10.html"><a href="Chapter10.html#bernoulli-and-binomial-glm"><i class="fa fa-check"></i><b>9.2</b> Bernoulli and binomial GLM</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="Chapter10.html"><a href="Chapter10.html#bernoulli-glm"><i class="fa fa-check"></i><b>9.2.1</b> Bernoulli GLM</a></li>
<li class="chapter" data-level="9.2.2" data-path="Chapter10.html"><a href="Chapter10.html#model-selection-with-the-marginal-likelihood"><i class="fa fa-check"></i><b>9.2.2</b> 10.2.2 Model selection with the marginal likelihood</a></li>
<li class="chapter" data-level="9.2.3" data-path="Chapter10.html"><a href="Chapter10.html#binomial-glm"><i class="fa fa-check"></i><b>9.2.3</b> Binomial GLM</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="Chapter10.html"><a href="Chapter10.html#gamma-glm"><i class="fa fa-check"></i><b>9.3</b> Gamma GLM</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Chapter11.html"><a href="Chapter11.html"><i class="fa fa-check"></i><b>10</b> Matern correlation and SPDE</a>
<ul>
<li class="chapter" data-level="10.1" data-path="Chapter11.html"><a href="Chapter11.html#continuous-gaussian-field"><i class="fa fa-check"></i><b>10.1</b> Continuous Gaussian field</a></li>
<li class="chapter" data-level="10.2" data-path="Chapter11.html"><a href="Chapter11.html#models-that-we-have-in-mind"><i class="fa fa-check"></i><b>10.2</b> Models that we have in mind</a></li>
<li class="chapter" data-level="10.3" data-path="Chapter11.html"><a href="Chapter11.html#matern-correlation"><i class="fa fa-check"></i><b>10.3</b> Matern correlation</a></li>
<li class="chapter" data-level="10.4" data-path="Chapter11.html"><a href="Chapter11.html#spde-approach"><i class="fa fa-check"></i><b>10.4</b> SPDE approach</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="Chapter11.html"><a href="Chapter11.html#mesh"><i class="fa fa-check"></i><b>10.4.1</b> Mesh</a></li>
<li class="chapter" data-level="10.4.2" data-path="Chapter11.html"><a href="Chapter11.html#finite-element-approach"><i class="fa fa-check"></i><b>10.4.2</b> Finite element approach</a></li>
<li class="chapter" data-level="10.4.3" data-path="Chapter11.html"><a href="Chapter11.html#simulation-study-with-five-points"><i class="fa fa-check"></i><b>10.4.3</b> Simulation study with five points</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="Chapter11.html"><a href="Chapter11.html#weighting-factors-again"><i class="fa fa-check"></i><b>10.5</b> Weighting factors … again</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Chapter12.html"><a href="Chapter12.html"><i class="fa fa-check"></i><b>11</b> Linear regression model with spatial dependency for the Irish pH data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="Chapter12.html"><a href="Chapter12.html#introduction-2"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="Chapter12.html"><a href="Chapter12.html#model-formulation-3"><i class="fa fa-check"></i><b>11.2</b> Model formulation</a></li>
<li class="chapter" data-level="11.3" data-path="Chapter12.html"><a href="Chapter12.html#linear-regression-results"><i class="fa fa-check"></i><b>11.3</b> Linear regression results</a></li>
<li class="chapter" data-level="11.4" data-path="Chapter12.html"><a href="Chapter12.html#model-validation-5"><i class="fa fa-check"></i><b>11.4</b> Model validation</a></li>
<li class="chapter" data-level="11.5" data-path="Chapter12.html"><a href="Chapter12.html#adding-spatial-correlation-to-the-model"><i class="fa fa-check"></i><b>11.5</b> Adding spatial correlation to the model</a></li>
<li class="chapter" data-level="11.6" data-path="Chapter12.html"><a href="Chapter12.html#defining-the-mesh-for-the-irish-ph-data"><i class="fa fa-check"></i><b>11.6</b> Defining the mesh for the Irish pH data</a></li>
<li class="chapter" data-level="11.7" data-path="Chapter12.html"><a href="Chapter12.html#define-the-weight-factor-aik"><i class="fa fa-check"></i><b>11.7</b> Define the weight factor aik</a></li>
<li class="chapter" data-level="11.8" data-path="Chapter12.html"><a href="Chapter12.html#define-the-spde"><i class="fa fa-check"></i><b>11.8</b> Define the SPDE</a></li>
<li class="chapter" data-level="11.9" data-path="Chapter12.html"><a href="Chapter12.html#define-the-spatial-field"><i class="fa fa-check"></i><b>11.9</b> Define the spatial field</a></li>
<li class="chapter" data-level="11.10" data-path="Chapter12.html"><a href="Chapter12.html#define-the-stack"><i class="fa fa-check"></i><b>11.10</b> Define the stack</a></li>
<li class="chapter" data-level="11.11" data-path="Chapter12.html"><a href="Chapter12.html#define-the-formula-for-the-spatial-model"><i class="fa fa-check"></i><b>11.11</b> Define the formula for the spatial model</a></li>
<li class="chapter" data-level="11.12" data-path="Chapter12.html"><a href="Chapter12.html#execute-the-spatial-model-in-r"><i class="fa fa-check"></i><b>11.12</b> Execute the spatial model in R</a></li>
<li class="chapter" data-level="11.13" data-path="Chapter12.html"><a href="Chapter12.html#results"><i class="fa fa-check"></i><b>11.13</b> Results</a></li>
<li class="chapter" data-level="11.14" data-path="Chapter12.html"><a href="Chapter12.html#model-selection-2"><i class="fa fa-check"></i><b>11.14</b> Model selection</a></li>
<li class="chapter" data-level="11.15" data-path="Chapter12.html"><a href="Chapter12.html#model-validation-6"><i class="fa fa-check"></i><b>11.15</b> Model validation</a></li>
<li class="chapter" data-level="11.16" data-path="Chapter12.html"><a href="Chapter12.html#s12-16"><i class="fa fa-check"></i><b>11.16</b> Model interpretation</a></li>
<li class="chapter" data-level="11.17" data-path="Chapter12.html"><a href="Chapter12.html#detailed-information-about-the-stack"><i class="fa fa-check"></i><b>11.17</b> Detailed information about the stack</a>
<ul>
<li class="chapter" data-level="11.17.1" data-path="Chapter12.html"><a href="Chapter12.html#stack-for-the-fitted-model-again"><i class="fa fa-check"></i><b>11.17.1</b> Stack for the fitted model again</a></li>
<li class="chapter" data-level="11.17.2" data-path="Chapter12.html"><a href="Chapter12.html#stack-for-the-new-covariate-values"><i class="fa fa-check"></i><b>11.17.2</b> Stack for the new covariate values</a></li>
<li class="chapter" data-level="11.17.3" data-path="Chapter12.html"><a href="Chapter12.html#combine-the-two-stacks"><i class="fa fa-check"></i><b>11.17.3</b> Combine the two stacks</a></li>
<li class="chapter" data-level="11.17.4" data-path="Chapter12.html"><a href="Chapter12.html#run-the-model"><i class="fa fa-check"></i><b>11.17.4</b> Run the model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="Chapter13.html"><a href="Chapter13.html"><i class="fa fa-check"></i><b>12</b> Spatial Poisson models applied to plant diversity</a>
<ul>
<li class="chapter" data-level="12.1" data-path="Chapter13.html"><a href="Chapter13.html#introduction-3"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="Chapter13.html"><a href="Chapter13.html#data-exploration-3"><i class="fa fa-check"></i><b>12.2</b> Data exploration</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="Chapter13.html"><a href="Chapter13.html#sampling-locations"><i class="fa fa-check"></i><b>12.2.1</b> Sampling locations</a></li>
<li class="chapter" data-level="12.2.2" data-path="Chapter13.html"><a href="Chapter13.html#outliers"><i class="fa fa-check"></i><b>12.2.2</b> Outliers</a></li>
<li class="chapter" data-level="12.2.3" data-path="Chapter13.html"><a href="Chapter13.html#collinearity"><i class="fa fa-check"></i><b>12.2.3</b> Collinearity</a></li>
<li class="chapter" data-level="12.2.4" data-path="Chapter13.html"><a href="Chapter13.html#relationships"><i class="fa fa-check"></i><b>12.2.4</b> Relationships</a></li>
<li class="chapter" data-level="12.2.5" data-path="Chapter13.html"><a href="Chapter13.html#number-of-zeros"><i class="fa fa-check"></i><b>12.2.5</b> Number of zeros</a></li>
<li class="chapter" data-level="12.2.6" data-path="Chapter13.html"><a href="Chapter13.html#conclusions-data-exploration"><i class="fa fa-check"></i><b>12.2.6</b> Conclusions data exploration</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="Chapter13.html"><a href="Chapter13.html#model-formulation-4"><i class="fa fa-check"></i><b>12.3</b> Model formulation</a></li>
<li class="chapter" data-level="12.4" data-path="Chapter13.html"><a href="Chapter13.html#glm-results"><i class="fa fa-check"></i><b>12.4</b> GLM results</a></li>
<li class="chapter" data-level="12.5" data-path="Chapter13.html"><a href="Chapter13.html#adding-spatial-correlation-to-the-model-1"><i class="fa fa-check"></i><b>12.5</b> Adding spatial correlation to the model</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="Chapter13.html"><a href="Chapter13.html#model-formulation-5"><i class="fa fa-check"></i><b>12.5.1</b> Model formulation</a></li>
<li class="chapter" data-level="12.5.2" data-path="Chapter13.html"><a href="Chapter13.html#mesh-1"><i class="fa fa-check"></i><b>12.5.2</b> Mesh</a></li>
<li class="chapter" data-level="12.5.3" data-path="Chapter13.html"><a href="Chapter13.html#projector-matrix"><i class="fa fa-check"></i><b>12.5.3</b> Projector matrix</a></li>
<li class="chapter" data-level="12.5.4" data-path="Chapter13.html"><a href="Chapter13.html#spde"><i class="fa fa-check"></i><b>12.5.4</b> SPDE</a></li>
<li class="chapter" data-level="12.5.5" data-path="Chapter13.html"><a href="Chapter13.html#spatial-field"><i class="fa fa-check"></i><b>12.5.5</b> Spatial field</a></li>
<li class="chapter" data-level="12.5.6" data-path="Chapter13.html"><a href="Chapter13.html#stack"><i class="fa fa-check"></i><b>12.5.6</b> Stack</a></li>
<li class="chapter" data-level="12.5.7" data-path="Chapter13.html"><a href="Chapter13.html#formula"><i class="fa fa-check"></i><b>12.5.7</b> Formula</a></li>
<li class="chapter" data-level="12.5.8" data-path="Chapter13.html"><a href="Chapter13.html#run-r-inla"><i class="fa fa-check"></i><b>12.5.8</b> Run R-INLA</a></li>
<li class="chapter" data-level="12.5.9" data-path="Chapter13.html"><a href="Chapter13.html#inspect-results"><i class="fa fa-check"></i><b>12.5.9</b> Inspect results</a>
<ul>
<li class="chapter" data-level="12.5.9.1" data-path="Chapter13.html"><a href="Chapter13.html#plotting-interpolated-wk"><i class="fa fa-check"></i><b>12.5.9.1</b> Plotting interpolated wk</a></li>
<li class="chapter" data-level="12.5.9.2" data-path="Chapter13.html"><a href="Chapter13.html#plotting-the-random-intercepts-ui"><i class="fa fa-check"></i><b>12.5.9.2</b> Plotting the random intercepts ui</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="Chapter13.html"><a href="Chapter13.html#simulating-from-the-model"><i class="fa fa-check"></i><b>12.6</b> Simulating from the model</a></li>
<li class="chapter" data-level="12.7" data-path="Chapter13.html"><a href="Chapter13.html#what-to-write-in-a-paper"><i class="fa fa-check"></i><b>12.7</b> What to write in a paper</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Chapter14.html"><a href="Chapter14.html"><i class="fa fa-check"></i><b>13</b> Time-series analysis in R-INLA</a>
<ul>
<li class="chapter" data-level="13.1" data-path="Chapter14.html"><a href="Chapter14.html#simulation-study-1"><i class="fa fa-check"></i><b>13.1</b> Simulation study</a></li>
<li class="chapter" data-level="13.2" data-path="Chapter14.html"><a href="Chapter14.html#trends-in-migration-dates-of-sockeye-salmon"><i class="fa fa-check"></i><b>13.2</b> Trends in migration dates of sockeye salmon</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="Chapter14.html"><a href="Chapter14.html#applying-a-random-walk-trend-model"><i class="fa fa-check"></i><b>13.2.1</b> Applying a random walk trend model</a></li>
<li class="chapter" data-level="13.2.2" data-path="Chapter14.html"><a href="Chapter14.html#posterior-distribution-of-sigmas"><i class="fa fa-check"></i><b>13.2.2</b> Posterior distribution of sigmas</a></li>
<li class="chapter" data-level="13.2.3" data-path="Chapter14.html"><a href="Chapter14.html#covariates-and-trends"><i class="fa fa-check"></i><b>13.2.3</b> Covariates and trends</a></li>
<li class="chapter" data-level="13.2.4" data-path="Chapter14.html"><a href="Chapter14.html#making-the-trend-smoother"><i class="fa fa-check"></i><b>13.2.4</b> Making the trend smoother</a>
<ul>
<li class="chapter" data-level="13.2.4.1" data-path="Chapter14.html"><a href="Chapter14.html#changing-the-values-of-the-gamma-prior"><i class="fa fa-check"></i><b>13.2.4.1</b> Changing the values of the gamma prior</a></li>
<li class="chapter" data-level="13.2.4.2" data-path="Chapter14.html"><a href="Chapter14.html#changing-the-gamma-prior-to-the-pc-prior"><i class="fa fa-check"></i><b>13.2.4.2</b> changing the gamma prior to the PC prior</a></li>
<li class="chapter" data-level="13.2.4.3" data-path="Chapter14.html"><a href="Chapter14.html#changing-the-random-walk-model-rw2"><i class="fa fa-check"></i><b>13.2.4.3</b> Changing the random walk model: rw2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="Chapter14.html"><a href="Chapter14.html#trends-in-polar-bear-movements"><i class="fa fa-check"></i><b>13.3</b> Trends in polar bear movements</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sessioninfo.html"><a href="sessioninfo.html"><i class="fa fa-check"></i>実行環境</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to spatial-temporal data anlysis using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="time-series-analysis-in-r-inla" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">13</span> Time-series analysis in R-INLA<a href="Chapter14.html#time-series-analysis-in-r-inla" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>本章では、<code>INLA</code>で扱える時系列相関を考慮したモデルについて解説する。時系列分析についてより詳しい解説が必要な場合は、他の書籍を参照されたし<span class="citation">(e.g., <a href="#ref-Baba2018">馬場 2018</a>, <a href="#ref-Baba2019">2019</a>; <a href="#ref-Ravishanker2022">Ravishanker et al. 2022</a>)</span>。</p>
<div id="simulation-study-1" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Simulation study<a href="Chapter14.html#simulation-study-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>以下では、シミュレーションデータを用いて話を進める。<span class="math inline">\(Y_t\)</span>を時系列データとし、以下のモデル式をもとに得られるとする。</p>
<p><span class="math display">\[
\begin{aligned}
&amp;Y_t = \rm{Intercept} + \rm{Covariates_i} + \rm{Trend_t} + \epsilon_t \\
&amp;\epsilon_t \sim N(0, \sigma^2_{\epsilon})
\end{aligned}
\]</span></p>
<p>ここでトレンド項(<span class="math inline">\(\rm{Trend_t}\)</span>)が<span class="math inline">\(Times \times \beta\)</span>のように表せるとすれば、これは通常の線形回帰モデルである。しかしこの場合、時間的な疑似相関が生じてしまう。この問題を解決するため、いわゆるランダムウォークが用いられる。もっとも単純なランダムウォークモデルは以下のように書ける。<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a></p>
<p><span class="math display">\[
\begin{aligned}
&amp;Y_t = \rm{Intercept} + \rm{Covariates_i} + \mu_t + \epsilon_t \\
&amp;\mu_t = \mu_{t-1} + v_t\\
&amp;\epsilon_t \sim N(0, \sigma^2_{\epsilon}) \; and \; v_t \sim N(0, \sigma^2_v)
\end{aligned}
\]</span></p>
<p>このモデルでは、互いに独立な残差<span class="math inline">\(\epsilon_t\)</span>と<span class="math inline">\(v_t\)</span>がある。以下、これらについて理解するために<span class="math inline">\(\sigma_{\epsilon}\)</span>と<span class="math inline">\(\sigma_{v}\)</span>に様々な値を当てはめたときにシミュレートされる<span class="math inline">\(Y_t\)</span>を図示したのが図<a href="Chapter14.html#fig:timeseries-sim">13.1</a>である。1行目の3つは<span class="math inline">\(\sigma_{\epsilon} = 1,\sigma_v = 1\)</span><span class="math inline">\(、2行目の3つは\)</span><span class="math inline">\(\sigma_{\epsilon} = 1,\sigma_v = 0.1\)</span><span class="math inline">\(、3行目の3つは\)</span><span class="math inline">\(\sigma_{\epsilon} = 5, \sigma_v = 1\)</span><span class="math inline">\(、4行目の3つは\)</span><span class="math inline">\(\sigma_{\epsilon} = 1, \sigma_v = 5\)</span><span class="math inline">\(、5行目の3つは\)</span><span class="math inline">\(\sigma_{\epsilon} = 3, \sigma_v = 3\)</span>である。なお、線は<span class="math inline">\(\mu_t\)</span>を、点は<span class="math inline">\(Y_t\)</span>を表す。</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="Chapter14.html#cb461-1" tabindex="-1"></a>sigma_e <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">each =</span> <span class="dv">3</span>)</span>
<span id="cb461-2"><a href="Chapter14.html#cb461-2" tabindex="-1"></a>sigma_v <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">3</span>), <span class="at">each =</span> <span class="dv">3</span>)</span>
<span id="cb461-3"><a href="Chapter14.html#cb461-3" tabindex="-1"></a></span>
<span id="cb461-4"><a href="Chapter14.html#cb461-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb461-5"><a href="Chapter14.html#cb461-5" tabindex="-1"></a>tmax <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb461-6"><a href="Chapter14.html#cb461-6" tabindex="-1"></a>Intercept <span class="ot">&lt;-</span>  <span class="fl">3.2</span></span>
<span id="cb461-7"><a href="Chapter14.html#cb461-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">15</span>, <span class="at">nrow =</span> tmax)</span>
<span id="cb461-8"><a href="Chapter14.html#cb461-8" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">15</span>, <span class="at">nrow =</span> tmax)</span>
<span id="cb461-9"><a href="Chapter14.html#cb461-9" tabindex="-1"></a>mu[<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">15</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb461-10"><a href="Chapter14.html#cb461-10" tabindex="-1"></a>y[<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>] <span class="ot">&lt;-</span> Intercept <span class="sc">+</span> mu[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">15</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma_e)</span>
<span id="cb461-11"><a href="Chapter14.html#cb461-11" tabindex="-1"></a></span>
<span id="cb461-12"><a href="Chapter14.html#cb461-12" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="fu">seq_along</span>(sigma_e)){</span>
<span id="cb461-13"><a href="Chapter14.html#cb461-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb461-14"><a href="Chapter14.html#cb461-14" tabindex="-1"></a>     mu[i,j] <span class="ot">&lt;-</span> mu[i<span class="dv">-1</span>,j] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="dv">0</span>, sigma_v[j])</span>
<span id="cb461-15"><a href="Chapter14.html#cb461-15" tabindex="-1"></a>     y[i, j] <span class="ot">&lt;-</span> Intercept <span class="sc">+</span> mu[i,j] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="dv">0</span>, sigma_e[j]) </span>
<span id="cb461-16"><a href="Chapter14.html#cb461-16" tabindex="-1"></a>  }</span>
<span id="cb461-17"><a href="Chapter14.html#cb461-17" tabindex="-1"></a>}</span>
<span id="cb461-18"><a href="Chapter14.html#cb461-18" tabindex="-1"></a></span>
<span id="cb461-19"><a href="Chapter14.html#cb461-19" tabindex="-1"></a>y <span class="sc">%&gt;%</span> </span>
<span id="cb461-20"><a href="Chapter14.html#cb461-20" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb461-21"><a href="Chapter14.html#cb461-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb461-22"><a href="Chapter14.html#cb461-22" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb461-23"><a href="Chapter14.html#cb461-23" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(name, <span class="st">&quot;X&quot;</span>,<span class="st">&quot;&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb461-24"><a href="Chapter14.html#cb461-24" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> value))<span class="sc">+</span></span>
<span id="cb461-25"><a href="Chapter14.html#cb461-25" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb461-26"><a href="Chapter14.html#cb461-26" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> mu <span class="sc">%&gt;%</span> </span>
<span id="cb461-27"><a href="Chapter14.html#cb461-27" tabindex="-1"></a>              <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb461-28"><a href="Chapter14.html#cb461-28" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">time =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb461-29"><a href="Chapter14.html#cb461-29" tabindex="-1"></a>              <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb461-30"><a href="Chapter14.html#cb461-30" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(name, <span class="st">&quot;X&quot;</span>,<span class="st">&quot;&quot;</span>))),</span>
<span id="cb461-31"><a href="Chapter14.html#cb461-31" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> value <span class="sc">+</span> Intercept),</span>
<span id="cb461-32"><a href="Chapter14.html#cb461-32" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb461-33"><a href="Chapter14.html#cb461-33" tabindex="-1"></a>  <span class="fu">facet_rep_wrap</span>(<span class="sc">~</span>name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>,</span>
<span id="cb461-34"><a href="Chapter14.html#cb461-34" tabindex="-1"></a>                 <span class="at">repeat.tick.labels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb461-35"><a href="Chapter14.html#cb461-35" tabindex="-1"></a>                 <span class="at">ncol =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb461-36"><a href="Chapter14.html#cb461-36" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb461-37"><a href="Chapter14.html#cb461-37" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="fl">0.7</span>)<span class="sc">+</span></span>
<span id="cb461-38"><a href="Chapter14.html#cb461-38" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Simulated data&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:timeseries-sim"></span>
<img src="Introduction-to-Spatial-temporal-analysis-in-R_files/figure-html/timeseries-sim-1.png" alt="Examples of simulated data sets with different random walk trends. Each of the three panels on the same row represents a different simulation from the same model. The number above a panel is the simulation number. In simulations 1–3 (top row) we used σ ε = 1 and σ v = 1; in simulations 4–6 (second row) we used σ ε = 1 and σ v = 0.1; in simulations 7–9 we used σ ε = 5 and σ v = 1; in simulations 10–12 we used σ ε = 1 and σ v = 5; and in simulations 13–15 we used σ ε = 3 and σ v = 3." width="672" />
<p class="caption">
図13.1: Examples of simulated data sets with different random walk trends. Each of the three panels on the same row represents a different simulation from the same model. The number above a panel is the simulation number. In simulations 1–3 (top row) we used σ ε = 1 and σ v = 1; in simulations 4–6 (second row) we used σ ε = 1 and σ v = 0.1; in simulations 7–9 we used σ ε = 5 and σ v = 1; in simulations 10–12 we used σ ε = 1 and σ v = 5; and in simulations 13–15 we used σ ε = 3 and σ v = 3.
</p>
</div>
<p><br/></p>
<p>この図からは、<span class="math inline">\(\sigma_v\)</span>が小さいとトレンド項(<span class="math inline">\(\mu_t\)</span>)の変動も小さく、なめらかであることが分かる(e.g., 2行目)。反対に、<span class="math inline">\(\sigma_v\)</span>が大きいと<span class="math inline">\(\mu_t\)</span>の変動が大きくなる。一方で、<span class="math inline">\(\sigma_{\epsilon}\)</span>は大きいほど<span class="math inline">\(Y_t\)</span>がトレンド項<span class="math inline">\(\mu_t\)</span>の周りで大きくばらつく。ランダムウォークについてさらに詳しい解説は <span class="citation">Durbin and Koopman (<a href="#ref-Durbin2012">2012</a>)</span> や <span class="citation">馬場 (<a href="#ref-Baba2018">2018</a>)</span> 、<span class="citation">馬場 (<a href="#ref-Baba2019">2019</a>)</span> などを参照。</p>
</div>
<div id="trends-in-migration-dates-of-sockeye-salmon" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Trends in migration dates of sockeye salmon<a href="Chapter14.html#trends-in-migration-dates-of-sockeye-salmon" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="applying-a-random-walk-trend-model" class="section level3 hasAnchor" number="13.2.1">
<h3><span class="header-section-number">13.2.1</span> Applying a random walk trend model<a href="Chapter14.html#applying-a-random-walk-trend-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>以下では、ベニザケの回遊日を研究した <span class="citation">Crozier et al. (<a href="#ref-Crozier2011">2011</a>)</span> のデータを用いる。</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="Chapter14.html#cb462-1" tabindex="-1"></a>salmon <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/sockeye.csv&quot;</span>)</span>
<span id="cb462-2"><a href="Chapter14.html#cb462-2" tabindex="-1"></a></span>
<span id="cb462-3"><a href="Chapter14.html#cb462-3" tabindex="-1"></a><span class="fu">datatable</span>(salmon,</span>
<span id="cb462-4"><a href="Chapter14.html#cb462-4" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="dv">30</span>),</span>
<span id="cb462-5"><a href="Chapter14.html#cb462-5" tabindex="-1"></a>          <span class="at">filter =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b4bb1d5fe3832831cde1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b4bb1d5fe3832831cde1">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1950\" data-max=\"2010\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"172\" data-max=\"193\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-6\" data-max=\"0\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"130.5766667\" data-max=\"664.7266667\" data-scale=\"7\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"93\" data-max=\"178\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"12.75066667\" data-max=\"18.351\" data-scale=\"8\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-95\" data-max=\"10\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-64\" data-max=\"57\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-11\" data-max=\"101\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.1517857\" data-max=\"0.9454515\" data-scale=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-2.351666667\" data-max=\"1.918333333\" data-scale=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-2.135\" data-max=\"2.975\" data-scale=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"6.666666667\" data-max=\"14.73333333\" data-scale=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-10\" data-max=\"10\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-6\" data-max=\"0\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-346.51\" data-max=\"254.931\" data-scale=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-49\" data-max=\"54\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-2.824333333\" data-max=\"3.909666667\" data-scale=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-95\" data-max=\"101\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-82\" data-max=\"82\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-78\" data-max=\"83\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-0.297474\" data-max=\"0.3878098\" data-scale=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-3.201666666\" data-max=\"2.63\" data-scale=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-3.765\" data-max=\"4.225\" data-scale=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-5.650000003\" data-max=\"5.466666663\" data-scale=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-17\" data-max=\"0\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"5.364052\" data-max=\"12.246464\" data-scale=\"6\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-0.644785096\" data-max=\"0\" data-scale=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61"],[1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010],[193,182,177,186,184,188,187,182,186,190,178,182,184,183,185,184,184,187,178,183,186,188,187,182,186,184,182,177,178,182,186,179,183,181,177,177,183,179,181,180,182,188,180,179,176,178,178,182,180,182,174,172,179,178,174,178,177,174,175,176,175],[0,0,0,0,0,0,0,-1,-4,0,0,0,0,-0.2,0,-2,0,-1,-1,0,-3,0,-1,-1,0,0,0,-3,0,-2,-1,0,0,-1,0,-3,-3,-6,-3.6,-1.8,-2,-3,-5.2,-1,0,-1,-1,-1,-3,-0.2,0,0,0,0,0,-2,-2,0,-1,-1,0],[588.473,464.9023333,418.7756667,516.686,510.8513333,456.5033333,664.7266667,461.2243333,444.5466667,507.0966667,394.4133333,587.29,390.18,393.5166667,572.9433333,481.3733333,339.27,571.26,368.7466667,332.1233333,338.94,486.6633333,543.2,144.82,467.9033333,328.17,294.7533333,130.5766667,244.7566667,179.1566667,287.92,359.28,371.3,292.8466667,354.9033333,198.75,257.2933333,150.8233333,172.7433333,194.9733333,307.5233333,278.8966667,186.9,228.409,194.9833333,283.451,387.6633333,483.34,305.88,344.5266667,217.7033333,136.83,322.1433333,261.7366667,249.01,197.8866667,318.0566667,219.5066667,368.4433333,283.6666667,326.2066667],[176,146,149,168,143,178,155,139,150,174,159,159,156,168,171,165,164,162,165,135,148,134,171,93,173,137,135,147,161,131,170,161,175,153,152,126,155,130,153,131,160,145,143,138,166,139,163,167,151,148,114,138,157,152,150,139,150,134,157,160,163],[12.75066667,14.18633333,14.72233333,14.12733333,13.48066667,13.961,13.9145,15.258,17.39033333,14.44433333,14.44433333,14.82343784,15.42688003,16.79076465,14.54861436,15.16725956,15.50757289,14.82343784,15.45699367,16.72673662,15.45787077,14.46616731,14.41646519,16.80918367,14.8398103,15.0984075,14.79215474,17.32579334,15.71924544,16.45074368,15.49933333,15.68633333,15.96266667,16.92666667,15.22166667,17.37066667,17.80766667,17.15866667,16.24008333,17.04666667,15.69866667,15.05333333,18.351,16.325,16.98566667,16.93333333,15.52666667,15.56,17.069375,15.93,16.89,16.83333333,14.28333333,15.30333333,15.065,16.725,16.56333333,16.77,14.28666667,16.98333333,15.36],[-49,-2,1,-17,2,1,-22,-28,-4,-9,-16,-91,-6,-3,2,10,-50,-15,-47,-2,1,-49,-25,-1,-37,-1,-10,8,-1,0,1,-14,-5,-95,-33,-5,-36,-38,-9,-59,-4,1,4,-35,-7,-37,0,-42,-1,-66,-13,0,-6,-82,-5,-9,-68,-8,-9,-5,-29],[-4,34,-2,-3,4,0,57,13,-1,21,-25,11,-7,-9,57,5,43,11,47,-21,25,-2,-1,43,2,35,0,1,-1,6,-7,0,-2,3,-8,5,13,-1,0,1,11,7,-11,-64,4,2,-53,-2,9,31,0,0,17,-17,1,-10,1,0,9,25,0],[49,16,18,2,28,67,57,10,38,33,-11,1,42,8,45,84,101,88,33,13,33,66,34,25,26,26,21,9,28,34,52,12,79,35,-2,15,1,23,-6,26,9,51,66,-4,22,69,34,1,20,31,7,45,14,27,16,-2,29,53,34,13,9],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9454515,0.7780323,0.4570525,0.6764258,0.674319,0.768353,0.5409125,0.4936944,0.4173018,0.7800435,0.2434385,0.5117836,0.5269557,0.5046433,0.598952,0.462285,0.3231163,0.7429876,0.5134593,0.3493613,0.5742257,0.6909328,0.4276231,0.1723716,0.4425448,0.6136866,0.425019,0.1517857,0.5170154,0.6000339,0.609808,0.4701612,0.6656143,0.7834588,0.7101583,0.2405063,0.8445901,0.7317514,0.7800382,0.6283161,0.886593424,0.853385224,0.828698643,0.862416127],[-1.733333333,-0.978333333,-1.138333333,-0.206666667,-0.783333333,-1.043333333,-2.351666667,-0.626666667,0.485,0.063333333,0.278333333,0.358333333,-1.428333333,-0.508333333,-0.848333333,-0.653333333,-0.425,-0.671666667,-0.603333333,-0.77,0.615,-1.571666667,-1.833333333,-0.558333333,-0.888333333,-0.75,-1.188333333,0.885,0.771666667,-0.01,0.761666667,1.023333333,0.105,1.29,1.498333333,0.631666667,1.333333333,1.918333333,1.166666667,-0.513333333,-0.178333333,-1.283333333,0.568333333,0.811666667,0.991666667,0.203333333,1.025,0.668333333,1.173333333,-0.473333333,-0.645,0.208333333,-0.446666667,1.586666667,0.55,0.888333333,0.47,-0.018333333,-0.991666667,-1.323333333,0.595],[-1.645,-0.735,-1.105,1.285,0.655,0.12,-0.085,-1.565,-0.655,-0.445,0.995,1.575,-0.285,-0.61,0.57,-1.045,-1.285,-1.005,-0.96,-1.06,0.095,0.325,-0.635,-0.245,-0.25,0.905,1.975,1.795,1.02,-0.88,-1.15,-0.56,-0.665,-0.035,0.485,0.25,-1.195,0.415,1.415,1.03,0.125,-0.75,-0.865,-2.135,-1.935,-1.735,-0.885,-1.25,0.895,1.92,2.32,2.975,2.04,1.865,0.38,-0.79,-0.072166667,0.4745,1.38101867,0.50739665,1.327225],[12.48333333,11.3,12.58333333,8.816666667,12.38333333,13.66666667,12.73333333,11.23333333,9.483333333,11.9,11.13333333,9.216666667,12.93333333,10.36666667,12.4,11.6,12.38333333,13.11666667,11,12.13333333,8.716666667,12,13.66666667,11.5,10.08333333,12.16666667,11.3,9.083333333,8.616666667,11.78333333,8.633333333,7.083333333,13.11666667,6.666666667,9.583333333,12.53333333,7.466666667,7.8,9.683333333,13.7,11.8,10.91666667,8.966666667,9.35,10.91666667,8.966666667,8.716666667,9.216666667,8.05,11.85,10.36666667,9.65,12,8.533333333,8.583333333,9.266666667,11.45,9.95,11.86666667,14.73333333,8.6],[null,null,null,null,-9,6,10,-4,2,2,-9,0,-2,-7,7,2,0,4,-7,2,2,1,9,-4,0,-4,-5,-5,-8,-2,4,2,5,-1,-9,-2,0,-2,4,3,-1,9,-1,-1,-6,-10,-2,3,4,4,-4,-10,-1,-4,0,6,-2,-4,0,-2,-2],[null,null,null,null,0,0,0,0,0,0,0,-1,-4,0,0,0,0,-0.2,0,-2,0,-1,-1,0,-3,0,-1,-1,0,0,0,-3,0,-2,-1,0,0,-1,0,-3,-3,-6,-3.6,-1.8,-2,-3,-5.2,-1,0,-1,-1,-1,-3,-0.2,0,0,0,0,0,-2,-2],[null,null,null,null,-77.6216667,-8.399,245.951,-55.4616667,-66.3046666,50.5933334,-270.3133334,126.0656667,-54.3666667,-113.58,178.53,-105.9166667,-50.91,177.7433333,-204.1966666,-149.25,-0.33,-84.5966667,174.4533333,-187.3033333,128.9633333,-158.4933333,-248.4466667,-14.2433333,-223.1466666,-149.0133333,-6.8333333,228.7033333,126.5433333,113.69,66.9833333,-160.53,-114.0066667,-142.0233334,-182.16,-3.7766667,50.23,128.0733334,14.1566667,33.4356667,-112.54,4.5543333,200.7633333,254.931,110.8966667,61.0756667,-169.96,-346.51,16.2633333,-82.79,31.3066667,61.0566667,-4.0866666,-42.23,119.4333333,85.77999997,8.149999967],[null,null,null,null,-33,32,6,-29,7,-4,4,20,6,-6,12,6,8,-6,-6,-30,-16,-28,6,-42,25,3,-36,54,-12,-6,35,14,14,22,-18,-35,-20,-23,1,5,5,15,-10,7,6,-6,20,29,-15,9,-49,-29,6,4,36,1,-7,-18,7,21,13],[null,null,null,null,0.73,-0.225333333,-0.807833333,1.130666667,3.909666667,0.483333333,0.529833333,-0.434562164,-1.963453299,2.346431313,0.104281024,0.343821721,0.080692853,-1.96732681,0.908379313,1.559477067,-0.049702122,-0.357270525,-1.04052848,0.082447047,-0.618060466,0.632240188,0.375689547,0.516609667,0.87943514,1.352336185,0.707178597,-1.639460005,0.243421228,0.475922983,-0.277666667,1.684333333,1.845,0.232,1.018416667,-0.324,-2.109,-2.105333333,2.110916667,-0.721666667,1.287,1.88,-2.824333333,-0.765,0.083708333,-1.003333333,1.363333333,1.273333333,-2.786041667,-0.626666667,-1.825,-0.108333333,2.28,1.466666667,-0.778333333,0.258333333,-1.203333333],[null,null,null,null,51,3,-23,-11,-6,-10,6,-63,-2,6,18,101,-44,-12,-49,-12,51,-34,22,1,-38,48,15,9,36,1,11,-22,-4,-95,-34,9,-31,57,24,-54,32,39,13,24,-3,-38,-4,-7,6,-29,-13,42,-5,-16,8,-9,-62,74,-4,4,39],[null,null,null,null,8,-34,59,16,-5,21,-82,-2,-6,-30,82,-6,50,20,-10,-26,-18,-13,-48,64,-23,37,1,-42,-3,-29,-7,-1,-1,-3,-1,5,15,-4,8,-4,-2,8,-11,-65,-7,-5,-42,62,5,29,53,2,8,-48,1,-10,-16,17,8,35,-1],[null,null,null,null,-21,51,39,8,10,-34,-68,-9,4,-25,56,83,59,80,-12,-71,-68,-22,1,12,-7,-40,-13,-16,2,8,31,3,51,1,-54,3,-78,-12,-4,11,8,28,72,-30,13,18,-32,5,-2,-38,-27,44,-6,-4,9,-47,15,26,18,15,-20],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,-0.2711325,-0.0096793,0.08386,-0.1827314,-0.2570172,0.0116905,-0.297474,0.0180892,0.1096539,-0.2754002,0.3555135,-0.0494986,-0.2038394,0.2383443,-0.0854927,-0.1129237,0.2511094,-0.0520548,-0.0858362,-0.1769897,-0.1316809,-0.0772462,-0.0026041,-0.0205859,0.0744706,-0.0136527,0.184789,0.3183755,0.1485989,0.1834249,0.1003503,-0.2296549,0.1789758,-0.0517074,0.0698799,0.3878098,0.042003324,0.121633824,0.048660443,0.234100027],[null,null,null,null,0.95,-0.065,-1.213333334,-0.42,1.268333333,1.106666666,2.63,0.985,-1.913333333,-0.571666666,-1.126666666,-1.011666666,1.003333333,-0.163333334,0.245,-0.116666667,1.04,-0.9,-1.23,0.211666667,-1.503333333,0.821666667,0.645,1.443333333,1.66,0.74,1.95,0.138333333,-0.666666667,1.3,0.736666666,-0.391666666,1.228333333,0.628333333,-0.331666666,-1.145,-1.511666666,-3.201666666,-0.598333334,1.325,1.17,1.486666666,0.456666667,-0.143333334,0.181666666,-0.676666666,-1.67,-0.46,-1.62,2.06,1.195,0.68,0.916666667,-1.605,-1.541666667,-2.211666666,0.125],[null,null,null,null,2.3,0.855,1.02,-2.85,-1.31,-0.565,1.08,3.14,0.37,-0.165,-0.425,-2.62,-1,-0.395,-1.53,-0.015,1.38,1.33,0.325,0.815,-0.345,0.58,2.61,2.04,1.27,-1.785,-3.125,-2.355,-1.685,0.845,1.635,0.81,-0.53,0.45,0.93,0.78,1.32,-1.165,-2.28,-3.165,-2.06,-0.985,-0.02,0.885,2.83,3.655,3.205,4.225,1.145,-0.055,-1.94,-3.765,-2.112166667,-1.3905,1.00101867,1.29739665,1.399391667],[null,null,null,null,-0.1,2.36666667,0.15,2.416666663,-2.899999997,-1.76666667,-1.6,-2.016666663,3.449999997,-1.53333333,1.26666667,2.383333333,-0.55,2.75,-1.4,0.53333333,-3.666666663,-1.11666667,2.66666667,-0.63333333,1.366666663,0.16666667,-2.36666667,-2.416666667,-1.466666663,-0.38333334,-2.666666667,-2,4.500000003,-5.116666663,0.95,5.449999997,-5.650000003,1.133333333,0.1,1.16666667,4.333333333,3.11666667,-0.716666666,-4.35,-0.88333333,-1.950000003,-0.25,-0.133333333,-2.86666667,2.883333333,1.650000003,0.433333333,3.95,-3.316666667,-1.783333337,-0.383333333,-0.55,1.416666667,3.283333337,5.466666663,-2.85],[null,null,null,null,0,0,0,0,0,0,0,-1,-4,0,0,-1,-4,-0.4,0,-3,-4,-1.4,-1,-3,-7,-1.4,-2,-4,-7,-1.4,-2,-7,-7,-3.4,-3,-7,-7,-4.4,-3,-10,-10,-10.4,-6.8,-11.8,-12,-13.4,-11.8,-12.8,-12,-14.4,-12.8,-13.8,-15,-14.4,-12.8,-13.8,-15,-14.4,-12.8,-15.8,-17],[6.958713,9.128202,8.158586,7.939164,9.010579,5.929958,7.975605,9.329613,9.834059,8.754663,9.881182,8.743341,8.576911,10.808012,7.717008,12.246464,9.760994,7.70312,10.07847,5.364052,11.689433,8.184192,10.875837,8.970524,8.240356,7.37088,9.878907,7.534817,9.151349,11.301256,7.730603,7.013942,9.162651,8.370602,8.932544,8.698723,10.734659,9.305426,8.941497,9.995482,8.449493,8.509736,9.792824,9.144366,7.508789,9.64118,8.393193,10.405767,10.20125,9.457782,7.898089,7.687926,7.853048,8.883482,8.730761,9.460244,9.142447,9.608181,6.690334,7.597702,7.162119],[0,0,0,0,0,0,0,-0.107185582,-0.406749644,0,0,0,0,-0.018504791,0,-0.163312447,0,-0.129817528,-0.09922141,0,-0.256642046,0,-0.091946946,-0.111476208,0,0,0,-0.398151674,0,-0.17697148,-0.129356015,0,0,-0.119465721,0,-0.344878208,-0.279468589,-0.644785096,-0.402617146,-0.180081361,-0.236700593,-0.352537376,-0.531001068,-0.109356953,0,-0.103721744,-0.119144168,-0.096100557,-0.294081608,-0.021146607,0,0,0,0,0,-0.211411038,-0.218759813,0,-0.149469369,-0.131618745,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Year<\/th>\n      <th>MigDay<\/th>\n      <th>S1997<\/th>\n      <th>F<\/th>\n      <th>FP<\/th>\n      <th>Temp<\/th>\n      <th>Umar<\/th>\n      <th>Uap<\/th>\n      <th>Umay<\/th>\n      <th>WRI<\/th>\n      <th>PDO<\/th>\n      <th>NPGO<\/th>\n      <th>NPI<\/th>\n      <th>D4<\/th>\n      <th>S4<\/th>\n      <th>F4<\/th>\n      <th>FP4<\/th>\n      <th>T4<\/th>\n      <th>Umar4<\/th>\n      <th>Uap4<\/th>\n      <th>Umay4<\/th>\n      <th>WRI4<\/th>\n      <th>PDO4<\/th>\n      <th>NPGO4<\/th>\n      <th>NPI4<\/th>\n      <th>cumS4<\/th>\n      <th>D.sd<\/th>\n      <th>betaS<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":30,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p><br/></p>
<p>図<a href="Chapter14.html#fig:salmon-mig">13.2</a>は年ごとの回遊日の中央値をプロットしたものである。</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="Chapter14.html#cb463-1" tabindex="-1"></a>salmon <span class="sc">%&gt;%</span> </span>
<span id="cb463-2"><a href="Chapter14.html#cb463-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> MigDay))<span class="sc">+</span></span>
<span id="cb463-3"><a href="Chapter14.html#cb463-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb463-4"><a href="Chapter14.html#cb463-4" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb463-5"><a href="Chapter14.html#cb463-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb463-6"><a href="Chapter14.html#cb463-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb463-7"><a href="Chapter14.html#cb463-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Migration day&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:salmon-mig"></span>
<img src="Introduction-to-Spatial-temporal-analysis-in-R_files/figure-html/salmon-mig-1.png" alt="Time-series plot of (median) arrival day versus year." width="768" />
<p class="caption">
図13.2: Time-series plot of (median) arrival day versus year.
</p>
</div>
<p><br/></p>
<p>リサーチクエスチョンは、このデータにトレンドが存在するかである。そこで、以下のランダムウォークモデルを適用する。</p>
<p><span class="math display" id="eq:randomtrend">\[
\begin{aligned}
&amp;MigDay_t = \rm{Intercept}  + \mu_t + \epsilon_t \\
&amp;\mu_t = \mu_{t-1} + v_t\\
&amp;\epsilon_t \sim N(0, \sigma^2_{\epsilon}) \; and \; v_t \sim N(0, \sigma^2_v)
\end{aligned}
\tag{13.1}
\]</span></p>
<p><code>INLA</code>では以下のようにモデルを実行できる。</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="Chapter14.html#cb464-1" tabindex="-1"></a>m14_1 <span class="ot">&lt;-</span> <span class="fu">inla</span>(MigDay <span class="sc">~</span> <span class="fu">f</span>(Year, <span class="at">model =</span> <span class="st">&quot;rw1&quot;</span>),</span>
<span id="cb464-2"><a href="Chapter14.html#cb464-2" tabindex="-1"></a>              <span class="at">control.compute =</span> <span class="fu">list</span>(<span class="at">dic =</span> <span class="cn">TRUE</span>),</span>
<span id="cb464-3"><a href="Chapter14.html#cb464-3" tabindex="-1"></a>              <span class="at">control.predictor =</span> <span class="fu">list</span>(<span class="at">compute =</span> <span class="cn">TRUE</span>),</span>
<span id="cb464-4"><a href="Chapter14.html#cb464-4" tabindex="-1"></a>              <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb464-5"><a href="Chapter14.html#cb464-5" tabindex="-1"></a>              <span class="at">data =</span> salmon)</span></code></pre></div>
<p>モデルの推定結果は以下のように求められる。</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="Chapter14.html#cb465-1" tabindex="-1"></a><span class="fu">summary</span>(m14_1)</span></code></pre></div>
<pre><code>## 
## Call:
##    c(&quot;inla.core(formula = formula, family = family, contrasts = contrasts, 
##    &quot;, &quot; data = data, quantiles = quantiles, E = E, offset = offset, &quot;, &quot; 
##    scale = scale, weights = weights, Ntrials = Ntrials, strata = strata, 
##    &quot;, &quot; lp.scale = lp.scale, link.covariates = link.covariates, verbose = 
##    verbose, &quot;, &quot; lincomb = lincomb, selection = selection, control.compute 
##    = control.compute, &quot;, &quot; control.predictor = control.predictor, 
##    control.family = control.family, &quot;, &quot; control.inla = control.inla, 
##    control.fixed = control.fixed, &quot;, &quot; control.mode = control.mode, 
##    control.expert = control.expert, &quot;, &quot; control.hazard = control.hazard, 
##    control.lincomb = control.lincomb, &quot;, &quot; control.update = 
##    control.update, control.lp.scale = control.lp.scale, &quot;, &quot; 
##    control.pardiso = control.pardiso, only.hyperparam = only.hyperparam, 
##    &quot;, &quot; inla.call = inla.call, inla.arg = inla.arg, num.threads = 
##    num.threads, &quot;, &quot; blas.num.threads = blas.num.threads, keep = keep, 
##    working.directory = working.directory, &quot;, &quot; silent = silent, inla.mode 
##    = inla.mode, safe = FALSE, debug = debug, &quot;, &quot; .parent.frame = 
##    .parent.frame)&quot;) 
## Time used:
##     Pre = 0.669, Running = 0.533, Post = 0.0676, Total = 1.27 
## Fixed effects:
##                mean    sd 0.025quant 0.5quant 0.975quant    mode kld
## (Intercept) 181.279 0.423    180.447  181.279     182.11 181.279   0
## 
## Random effects:
##   Name     Model
##     Year RW1 model
## 
## Model hyperparameters:
##                                          mean    sd 0.025quant 0.5quant
## Precision for the Gaussian observations 0.095 0.019      0.064    0.093
## Precision for Year                      3.790 2.685      0.633    3.158
##                                         0.975quant mode
## Precision for the Gaussian observations      0.137 0.09
## Precision for Year                          10.634 1.79
## 
## Deviance Information Criterion (DIC) ...............: 326.14
## Deviance Information Criterion (DIC, saturated) ....: 69.42
## Effective number of parameters .....................: 6.69
## 
## Marginal log-Likelihood:  -187.05 
##  is computed 
## Posterior summaries for the linear predictor and the fitted values are computed
## (Posterior marginals needs also &#39;control.compute=list(return.marginals.predictor=TRUE)&#39;)</code></pre>
<p>トレンド項<span class="math inline">\(\mu_t\)</span>は時間とともに変化するランダム効果であり、その情報は以下で確認できる。</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="Chapter14.html#cb467-1" tabindex="-1"></a>m14_1<span class="sc">$</span>summary.random<span class="sc">$</span>Year</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["ID"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["0.025quant"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["0.5quant"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["0.975quant"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["mode"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["kld"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"1950","2":"3.56855393","3":"1.2674825","4":"1.208409973","5":"3.52125935","6":"6.21096099","7":"3.44148422","8":"8.852339e-07"},{"1":"1951","2":"3.30747278","3":"1.1288930","4":"1.136342080","5":"3.28894638","6":"5.58290819","7":"3.25233138","8":"1.479726e-08"},{"1":"1952","2":"3.13700261","3":"1.0549601","4":"1.072169598","5":"3.13171238","6":"5.22770599","7":"3.11652654","8":"7.333950e-08"},{"1":"1953","2":"3.21433299","3":"1.0074754","4":"1.266043562","5":"3.20196731","6":"5.23269872","7":"3.17745760","8":"9.568970e-09"},{"1":"1954","2":"3.24370181","3":"0.9773474","4":"1.367286105","5":"3.22722585","6":"5.21595630","7":"3.19713664","8":"1.967663e-08"},{"1":"1955","2":"3.29521225","3":"0.9661625","4":"1.464538434","5":"3.27068394","6":"5.27231344","7":"3.22956297","8":"1.641830e-07"},{"1":"1956","2":"3.23937565","3":"0.9441750","4":"1.452182879","5":"3.21464817","6":"5.17439394","7":"3.17331074","8":"2.041224e-07"},{"1":"1957","2":"3.10755918","3":"0.9154446","4":"1.358824796","5":"3.08871156","6":"4.96702940","7":"3.05527872","8":"8.971333e-08"},{"1":"1958","2":"3.06058847","3":"0.9068631","4":"1.337662669","5":"3.03859578","6":"4.91375613","7":"3.00076817","8":"2.390051e-07"},{"1":"1959","2":"2.96354972","3":"0.8943675","4":"1.261741179","5":"2.94251136","6":"4.78927600","7":"2.90593109","8":"3.914696e-07"},{"1":"1960","2":"2.67859878","3":"0.8763393","4":"0.945367794","5":"2.67813343","6":"4.40623572","7":"2.66912763","8":"6.852941e-07"},{"1":"1961","2":"2.59144589","3":"0.8708988","4":"0.864788358","5":"2.59177954","6":"4.30639453","7":"2.58355471","8":"5.753690e-07"},{"1":"1962","2":"2.56480637","3":"0.8651096","4":"0.866556126","5":"2.55985065","6":"4.28412590","7":"2.54407798","8":"2.644709e-07"},{"1":"1963","2":"2.53234190","3":"0.8625391","4":"0.852116386","5":"2.52326514","6":"4.25872077","7":"2.50117167","8":"2.230131e-07"},{"1":"1964","2":"2.52759652","3":"0.8637277","4":"0.867586333","5":"2.51142974","6":"4.27742063","7":"2.47882483","8":"2.390219e-07"},{"1":"1965","2":"2.48530503","3":"0.8647302","4":"0.833114922","5":"2.46595715","6":"4.24637792","7":"2.42805853","8":"2.741818e-07"},{"1":"1966","2":"2.43828310","3":"0.8666197","4":"0.792048681","5":"2.41580041","6":"4.21221433","7":"2.37265473","8":"3.245912e-07"},{"1":"1967","2":"2.38562878","3":"0.8693003","4":"0.743838280","5":"2.35999777","6":"4.17406744","7":"2.31159248","8":"4.028329e-07"},{"1":"1968","2":"2.22560840","3":"0.8615344","4":"0.572061002","5":"2.20834893","6":"3.97203176","7":"2.17035462","8":"5.117263e-07"},{"1":"1969","2":"2.25159534","3":"0.8742455","4":"0.613959021","5":"2.22144099","6":"4.06258118","7":"2.16464795","8":"4.397683e-07"},{"1":"1970","2":"2.30051219","3":"0.9085033","4":"0.650431778","5":"2.25257647","6":"4.23907806","7":"2.17060192","8":"2.338744e-06"},{"1":"1971","2":"2.27815619","3":"0.9392132","4":"0.608394036","5":"2.21690511","6":"4.32725984","7":"2.11722984","8":"7.165844e-06"},{"1":"1972","2":"2.12018341","3":"0.9303181","4":"0.460545114","5":"2.06103014","6":"4.14317240","7":"1.96334250","8":"5.685868e-06"},{"1":"1973","2":"1.85397310","3":"0.8945185","4":"0.220441548","5":"1.80853828","6":"3.75601455","7":"1.72863673","8":"1.838409e-06"},{"1":"1974","2":"1.63457991","3":"0.8825035","4":"0.008699942","5":"1.59355389","6":"3.49942520","7":"1.52035318","8":"1.991024e-06"},{"1":"1975","2":"1.31975506","3":"0.8572438","4":"-0.307622820","5":"1.29410341","6":"3.08689535","7":"1.24303594","8":"5.781076e-07"},{"1":"1976","2":"0.96217096","3":"0.8459328","4":"-0.710999009","5":"0.95716808","6":"2.64789689","7":"0.93684618","8":"4.362812e-07"},{"1":"1977","2":"0.61207378","3":"0.8588054","4":"-1.161592808","5":"0.62968076","6":"2.26072135","7":"0.64394532","8":"4.899002e-06"},{"1":"1978","2":"0.41974133","3":"0.8581115","4":"-1.356778718","5":"0.43947654","6":"2.06315942","7":"0.46006683","8":"3.333032e-06"},{"1":"1979","2":"0.34553780","3":"0.8449403","4":"-1.358813933","5":"0.35193910","6":"2.00290632","7":"0.35578746","8":"4.756277e-07"},{"1":"1980","2":"0.25681603","3":"0.8430788","4":"-1.411747832","5":"0.25326902","6":"1.94090178","7":"0.24412454","8":"5.664850e-07"},{"1":"1981","2":"0.01935842","3":"0.8439245","4":"-1.681422314","5":"0.02630106","6":"1.67602134","7":"0.03542546","8":"3.996024e-07"},{"1":"1982","2":"-0.14262652","3":"0.8438052","4":"-1.842754434","5":"-0.13528496","6":"1.51385209","7":"-0.12335238","8":"3.878928e-07"},{"1":"1983","2":"-0.36845658","3":"0.8492188","4":"-2.107601541","5":"-0.35141909","6":"1.27121032","7":"-0.32305031","8":"7.090169e-07"},{"1":"1984","2":"-0.60081739","3":"0.8623015","4":"-2.403478211","5":"-0.57176740","6":"1.02945777","7":"-0.52502031","8":"3.066536e-06"},{"1":"1985","2":"-0.71653568","3":"0.8581699","4":"-2.499244511","5":"-0.69089397","6":"0.91556527","7":"-0.64873050","8":"2.321657e-06"},{"1":"1986","2":"-0.71867859","3":"0.8440561","4":"-2.417551887","5":"-0.71081061","6":"0.93841218","7":"-0.69469199","8":"3.824429e-07"},{"1":"1987","2":"-0.80404359","3":"0.8432754","4":"-2.485345300","5":"-0.80152270","6":"0.86733634","7":"-0.79397814","8":"3.472105e-07"},{"1":"1988","2":"-0.84043757","3":"0.8463822","4":"-2.492687617","5":"-0.84986656","6":"0.87356859","7":"-0.86089875","8":"4.562514e-07"},{"1":"1989","2":"-0.89340715","3":"0.8552512","4":"-2.532444834","5":"-0.91337196","6":"0.87167892","7":"-0.94017765","8":"1.000655e-06"},{"1":"1990","2":"-0.92890560","3":"0.8768903","4":"-2.565538278","5":"-0.96429578","6":"0.93217573","7":"-1.01212985","8":"4.441598e-06"},{"1":"1991","2":"-1.01181592","3":"0.8996194","4":"-2.657064900","5":"-1.05919681","6":"0.94106953","7":"-1.12070416","8":"1.887316e-05"},{"1":"1992","2":"-1.34198043","3":"0.8624628","4":"-2.985441285","5":"-1.36428247","6":"0.44853506","7":"-1.39106709","8":"1.623415e-06"},{"1":"1993","2":"-1.66904986","3":"0.8488508","4":"-3.339423039","5":"-1.67211309","6":"0.03059886","7":"-1.67021712","8":"3.525754e-07"},{"1":"1994","2":"-1.97446099","3":"0.8518320","4":"-3.691282650","5":"-1.96326665","6":"-0.31639178","7":"-1.94054283","8":"6.173258e-07"},{"1":"1995","2":"-2.17142747","3":"0.8541786","4":"-3.892533584","5":"-2.15981015","6":"-0.51179228","7":"-2.13582694","8":"3.635041e-07"},{"1":"1996","2":"-2.33328341","3":"0.8562878","4":"-4.046211825","5":"-2.32528099","6":"-0.65954006","7":"-2.30582850","8":"2.399532e-07"},{"1":"1997","2":"-2.46409778","3":"0.8624379","4":"-4.165737620","5":"-2.46353319","6":"-0.75509788","7":"-2.45368717","8":"6.254447e-07"},{"1":"1998","2":"-2.69977735","3":"0.8678162","4":"-4.422274301","5":"-2.69532230","6":"-0.99568169","7":"-2.67990736","8":"4.147672e-07"},{"1":"1999","2":"-2.98212290","3":"0.8776528","4":"-4.745057664","5":"-2.97028597","6":"-1.28478823","7":"-2.94456934","8":"1.942199e-07"},{"1":"2000","2":"-3.39011175","3":"0.9185566","4":"-5.292823597","5":"-3.35990005","6":"-1.66881777","7":"-3.30942646","8":"6.922351e-07"},{"1":"2001","2":"-3.67588926","3":"0.9565434","4":"-5.678587418","5":"-3.63903260","6":"-1.89936716","7":"-3.58088413","8":"1.467067e-06"},{"1":"2002","2":"-3.78509259","3":"0.9501622","4":"-5.738292506","5":"-3.75861306","6":"-1.99047715","7":"-3.71432680","8":"1.548066e-07"},{"1":"2003","2":"-3.95335566","3":"0.9683948","4":"-5.934690413","5":"-3.92937130","6":"-2.11552795","7":"-3.88948541","8":"8.228558e-08"},{"1":"2004","2":"-4.15302064","3":"1.0029723","4":"-6.208779609","5":"-4.12761804","6":"-2.25111032","7":"-4.08710004","8":"8.530372e-08"},{"1":"2005","2":"-4.25831196","3":"1.0197193","4":"-6.330071003","5":"-4.23778216","6":"-2.30966649","7":"-4.20436600","8":"2.811009e-08"},{"1":"2006","2":"-4.40613880","3":"1.0592090","4":"-6.557440679","5":"-4.38510658","6":"-2.38153072","7":"-4.35132277","8":"2.504117e-08"},{"1":"2007","2":"-4.56906014","3":"1.1180713","4":"-6.851483627","5":"-4.54354706","6":"-2.44178108","7":"-4.50323122","8":"3.607409e-08"},{"1":"2008","2":"-4.65416743","3":"1.1700858","4":"-7.044311462","5":"-4.62633048","6":"-2.43214295","7":"-4.58093060","8":"3.992588e-08"},{"1":"2009","2":"-4.69830587","3":"1.2322792","4":"-7.222426529","5":"-4.66590836","6":"-2.36819328","7":"-4.61100073","8":"5.208372e-08"},{"1":"2010","2":"-4.73631578","3":"1.3235417","4":"-7.473884563","5":"-4.69285341","6":"-2.25941538","7":"-4.61841779","8":"1.195386e-07"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>図示すると以下のようになる。</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="Chapter14.html#cb468-1" tabindex="-1"></a>m14_1<span class="sc">$</span>summary.random<span class="sc">$</span>Year <span class="sc">%&gt;%</span> </span>
<span id="cb468-2"><a href="Chapter14.html#cb468-2" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> ID) <span class="sc">%&gt;%</span> </span>
<span id="cb468-3"><a href="Chapter14.html#cb468-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> mean))<span class="sc">+</span></span>
<span id="cb468-4"><a href="Chapter14.html#cb468-4" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb468-5"><a href="Chapter14.html#cb468-5" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> <span class="st">`</span><span class="at">0.025quant</span><span class="st">`</span>, <span class="at">ymin =</span> <span class="st">`</span><span class="at">0.975quant</span><span class="st">`</span>),</span>
<span id="cb468-6"><a href="Chapter14.html#cb468-6" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb468-7"><a href="Chapter14.html#cb468-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb468-8"><a href="Chapter14.html#cb468-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb468-9"><a href="Chapter14.html#cb468-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Random walk trend&quot;</span>)</span></code></pre></div>
<p><img src="Introduction-to-Spatial-temporal-analysis-in-R_files/figure-html/unnamed-chunk-336-1.png" width="672" style="display: block; margin: auto;" />
<br/></p>
<p>切片も足した予測値は以下のように求められる。</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="Chapter14.html#cb469-1" tabindex="-1"></a>m14_1<span class="sc">$</span>summary.fitted.values <span class="sc">%&gt;%</span> </span>
<span id="cb469-2"><a href="Chapter14.html#cb469-2" tabindex="-1"></a>  <span class="fu">bind_cols</span>(salmon) <span class="sc">%&gt;%</span> </span>
<span id="cb469-3"><a href="Chapter14.html#cb469-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> mean))<span class="sc">+</span></span>
<span id="cb469-4"><a href="Chapter14.html#cb469-4" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb469-5"><a href="Chapter14.html#cb469-5" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> <span class="st">`</span><span class="at">0.025quant</span><span class="st">`</span>, <span class="at">ymin =</span> <span class="st">`</span><span class="at">0.975quant</span><span class="st">`</span>),</span>
<span id="cb469-6"><a href="Chapter14.html#cb469-6" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb469-7"><a href="Chapter14.html#cb469-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> MigDay),</span>
<span id="cb469-8"><a href="Chapter14.html#cb469-8" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb469-9"><a href="Chapter14.html#cb469-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb469-10"><a href="Chapter14.html#cb469-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb469-11"><a href="Chapter14.html#cb469-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Observed and fitted values&quot;</span>)</span></code></pre></div>
<p><img src="Introduction-to-Spatial-temporal-analysis-in-R_files/figure-html/unnamed-chunk-337-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="posterior-distribution-of-sigmas" class="section level3 hasAnchor" number="13.2.2">
<h3><span class="header-section-number">13.2.2</span> Posterior distribution of sigmas<a href="Chapter14.html#posterior-distribution-of-sigmas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>INLA</code>は精度<span class="math inline">\(\tau = 1/\sigma^2\)</span>を推定するので、<span class="math inline">\(\sigma_{\epsilon}\)</span>と<span class="math inline">\(\sigma_v\)</span>の事後分布を求めるためには以下のような変換が必要である。それぞれの事後平均は以下のように求められる。</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="Chapter14.html#cb470-1" tabindex="-1"></a>tau_eps <span class="ot">&lt;-</span> m14_1<span class="sc">$</span>marginals.hyperpar<span class="sc">$</span><span class="st">`</span><span class="at">Precision for the Gaussian observations</span><span class="st">`</span></span>
<span id="cb470-2"><a href="Chapter14.html#cb470-2" tabindex="-1"></a>tau_v <span class="ot">&lt;-</span> m14_1<span class="sc">$</span>marginals.hyperpar<span class="sc">$</span><span class="st">`</span><span class="at">Precision for Year</span><span class="st">`</span></span>
<span id="cb470-3"><a href="Chapter14.html#cb470-3" tabindex="-1"></a></span>
<span id="cb470-4"><a href="Chapter14.html#cb470-4" tabindex="-1"></a>fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(x)}</span>
<span id="cb470-5"><a href="Chapter14.html#cb470-5" tabindex="-1"></a>sigma_eps <span class="ot">&lt;-</span> <span class="fu">inla.emarginal</span>(fun, tau_eps)</span>
<span id="cb470-6"><a href="Chapter14.html#cb470-6" tabindex="-1"></a>sigma_v <span class="ot">&lt;-</span> <span class="fu">inla.emarginal</span>(fun, tau_v)</span>
<span id="cb470-7"><a href="Chapter14.html#cb470-7" tabindex="-1"></a></span>
<span id="cb470-8"><a href="Chapter14.html#cb470-8" tabindex="-1"></a><span class="fu">c</span>(sigma_eps, sigma_v)</span></code></pre></div>
<pre><code>## [1] 3.2863230 0.6197087</code></pre>
<p>事後分布は以下のように書ける。</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="Chapter14.html#cb472-1" tabindex="-1"></a>pd_sigma_eps <span class="ot">&lt;-</span> <span class="fu">inla.tmarginal</span>(fun, tau_eps)</span>
<span id="cb472-2"><a href="Chapter14.html#cb472-2" tabindex="-1"></a>pd_sigma_v <span class="ot">&lt;-</span> <span class="fu">inla.tmarginal</span>(fun, tau_v)</span>
<span id="cb472-3"><a href="Chapter14.html#cb472-3" tabindex="-1"></a></span>
<span id="cb472-4"><a href="Chapter14.html#cb472-4" tabindex="-1"></a>pd_sigma_eps <span class="sc">%&gt;%</span> </span>
<span id="cb472-5"><a href="Chapter14.html#cb472-5" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb472-6"><a href="Chapter14.html#cb472-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">par =</span> <span class="st">&quot;sigma_eps&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb472-7"><a href="Chapter14.html#cb472-7" tabindex="-1"></a>  <span class="fu">bind_rows</span>(pd_sigma_v <span class="sc">%&gt;%</span> </span>
<span id="cb472-8"><a href="Chapter14.html#cb472-8" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb472-9"><a href="Chapter14.html#cb472-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">par =</span> <span class="st">&quot;sigma_v&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb472-10"><a href="Chapter14.html#cb472-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y))<span class="sc">+</span></span>
<span id="cb472-11"><a href="Chapter14.html#cb472-11" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb472-12"><a href="Chapter14.html#cb472-12" tabindex="-1"></a>  <span class="fu">facet_rep_wrap</span>(<span class="sc">~</span>par, <span class="at">repeat.tick.labels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb472-13"><a href="Chapter14.html#cb472-13" tabindex="-1"></a>                 <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb472-14"><a href="Chapter14.html#cb472-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb472-15"><a href="Chapter14.html#cb472-15" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb472-16"><a href="Chapter14.html#cb472-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="Introduction-to-Spatial-temporal-analysis-in-R_files/figure-html/unnamed-chunk-339-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="covariates-and-trends" class="section level3 hasAnchor" number="13.2.3">
<h3><span class="header-section-number">13.2.3</span> Covariates and trends<a href="Chapter14.html#covariates-and-trends" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>式<a href="Chapter14.html#eq:randomtrend">(13.1)</a>のモデルは以下のように説明変数を加えて簡単に拡張できる。ここでは、気温(<span class="math inline">\(Temp_t\)</span>)を加える。</p>
<p><span class="math display" id="eq:randomtrend2">\[
\begin{aligned}
&amp;MigDay_t = \rm{Intercept}  + Temp_t \times \beta + \mu_t + \epsilon_t \\
&amp;\mu_t = \mu_{t-1} + v_t\\
&amp;\epsilon_t \sim N(0, \sigma^2_{\epsilon}) \; and \; v_t \sim N(0, \sigma^2_v)
\end{aligned}
\tag{13.2}
\]</span></p>
<p>このモデルは以下のように実行できる。</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="Chapter14.html#cb473-1" tabindex="-1"></a>f14_2 <span class="ot">&lt;-</span> MigDay <span class="sc">~</span> Temp <span class="sc">+</span> <span class="fu">f</span>(Year, <span class="at">model =</span> <span class="st">&quot;rw1&quot;</span>)</span>
<span id="cb473-2"><a href="Chapter14.html#cb473-2" tabindex="-1"></a></span>
<span id="cb473-3"><a href="Chapter14.html#cb473-3" tabindex="-1"></a>m14_2 <span class="ot">&lt;-</span> <span class="fu">inla</span>(f14_2,</span>
<span id="cb473-4"><a href="Chapter14.html#cb473-4" tabindex="-1"></a>              <span class="at">control.compute =</span> <span class="fu">list</span>(<span class="at">dic =</span> <span class="cn">TRUE</span>),</span>
<span id="cb473-5"><a href="Chapter14.html#cb473-5" tabindex="-1"></a>              <span class="at">control.predictor =</span> <span class="fu">list</span>(<span class="at">compute =</span> <span class="cn">TRUE</span>),</span>
<span id="cb473-6"><a href="Chapter14.html#cb473-6" tabindex="-1"></a>              <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb473-7"><a href="Chapter14.html#cb473-7" tabindex="-1"></a>              <span class="at">data =</span> salmon)</span></code></pre></div>
<p>先ほどのモデルと比べると、気温を共変量に加えたモデルの方がDICが低い。</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="Chapter14.html#cb474-1" tabindex="-1"></a><span class="fu">c</span>(m14_1<span class="sc">$</span>dic<span class="sc">$</span>dic, m14_2<span class="sc">$</span>dic<span class="sc">$</span>dic)</span></code></pre></div>
<pre><code>## [1] 326.1440 321.0941</code></pre>
<p>また、気温にかかる係数の95%確信区間は0を含まないので、応答変数に重要な影響を与えていることが示唆される。</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="Chapter14.html#cb476-1" tabindex="-1"></a>m14_2<span class="sc">$</span>summary.fixed</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["mean"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["0.025quant"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["0.5quant"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["0.975quant"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["mode"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["kld"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"199.832554","2":"6.5326203","3":"187.002260","4":"199.826396","5":"212.6986143","6":"199.815154","7":"4.440660e-09","_rn_":"(Intercept)"},{"1":"-1.182956","2":"0.4157274","3":"-2.001728","4":"-1.182566","5":"-0.3664471","6":"-1.181854","7":"4.438485e-09","_rn_":"Temp"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="making-the-trend-smoother" class="section level3 hasAnchor" number="13.2.4">
<h3><span class="header-section-number">13.2.4</span> Making the trend smoother<a href="Chapter14.html#making-the-trend-smoother" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(\sigma_v\)</span>の事前分布を変えたとき、トレンド項<span class="math inline">\(\mu_t\)</span>の事後分布は大きな影響を受ける。以下、このことをシミュレーションによって確認する。</p>
<div id="changing-the-values-of-the-gamma-prior" class="section level4 hasAnchor" number="13.2.4.1">
<h4><span class="header-section-number">13.2.4.1</span> Changing the values of the gamma prior<a href="Chapter14.html#changing-the-values-of-the-gamma-prior" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>INLA</code>では<span class="math inline">\(\tau_v = 1/\sigma_v^2\)</span>の事前分布はデフォルトでは<span class="math inline">\(Gamma(1, 0.00001)\)</span>になっている(第<a href="Chapter9.html#c9">8</a>章参照)。しかし、個の分布が最善かには議論がある。第<a href="Chapter9.html#c9">8</a>章では、 事前分布に<span class="math inline">\(Gamma(1, 0.5)\)</span>を用いたモデルも実行した。この事前分布は、 <span class="citation">Carroll et al. (<a href="#ref-Carroll2015">2015</a>)</span> によって推奨されているものである。この事前分布の下では、<span class="math inline">\(\sigma_v\)</span>はおよそ0から5までの値をとる。</p>
<p><code>INLA</code>では、以下のようにしてこの事前分布によるモデルを実行できる。</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="Chapter14.html#cb477-1" tabindex="-1"></a>f14_3 <span class="ot">&lt;-</span> MigDay <span class="sc">~</span> Temp <span class="sc">+</span> <span class="fu">f</span>(Year, <span class="at">model =</span> <span class="st">&quot;rw1&quot;</span>,</span>
<span id="cb477-2"><a href="Chapter14.html#cb477-2" tabindex="-1"></a>                           <span class="at">hyper =</span> <span class="fu">list</span>(<span class="at">theta =</span> <span class="fu">list</span>(<span class="at">prior =</span> <span class="st">&quot;loggamma&quot;</span>,</span>
<span id="cb477-3"><a href="Chapter14.html#cb477-3" tabindex="-1"></a>                                                     <span class="at">param =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>))))</span>
<span id="cb477-4"><a href="Chapter14.html#cb477-4" tabindex="-1"></a></span>
<span id="cb477-5"><a href="Chapter14.html#cb477-5" tabindex="-1"></a>m14_3 <span class="ot">&lt;-</span> <span class="fu">inla</span>(f14_3,</span>
<span id="cb477-6"><a href="Chapter14.html#cb477-6" tabindex="-1"></a>              <span class="at">control.compute =</span> <span class="fu">list</span>(<span class="at">dic =</span> <span class="cn">TRUE</span>),</span>
<span id="cb477-7"><a href="Chapter14.html#cb477-7" tabindex="-1"></a>              <span class="at">control.predictor =</span> <span class="fu">list</span>(<span class="at">compute =</span> <span class="cn">TRUE</span>),</span>
<span id="cb477-8"><a href="Chapter14.html#cb477-8" tabindex="-1"></a>              <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb477-9"><a href="Chapter14.html#cb477-9" tabindex="-1"></a>              <span class="at">data =</span> salmon)</span></code></pre></div>
<p><span class="citation">Blangiardo and Cameletti (<a href="#ref-Blangiardo2015">2015</a>)</span> は、<span class="math inline">\(\sigma_v\)</span>がとりうる範囲について事前に知識があれば、それをもとに事前分布のパラメータを検討することができることを示している。例えば、仮に<span class="math inline">\(\sigma_v\)</span>が0.3から0.7の範囲をとりうると分かっているとしよう。このとき、シミュレーションによって<span class="math inline">\(\sigma_v\)</span>を10000個生成する。</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="Chapter14.html#cb478-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb478-2"><a href="Chapter14.html#cb478-2" tabindex="-1"></a>sim.sigma_v <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="fl">0.3</span>,<span class="fl">0.7</span>)</span></code></pre></div>
<p>このとき、<span class="math inline">\(\tau_v\)</span>の分布は以下のようになる。</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="Chapter14.html#cb479-1" tabindex="-1"></a>sim.tau_v <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>sim.sigma_v<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb479-2"><a href="Chapter14.html#cb479-2" tabindex="-1"></a></span>
<span id="cb479-3"><a href="Chapter14.html#cb479-3" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> sim.tau_v) <span class="sc">%&gt;%</span> </span>
<span id="cb479-4"><a href="Chapter14.html#cb479-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x))<span class="sc">+</span></span>
<span id="cb479-5"><a href="Chapter14.html#cb479-5" tabindex="-1"></a>  <span class="fu">geom_density</span>()<span class="sc">+</span></span>
<span id="cb479-6"><a href="Chapter14.html#cb479-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb479-7"><a href="Chapter14.html#cb479-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb479-8"><a href="Chapter14.html#cb479-8" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">12</span>))</span></code></pre></div>
<p><img src="Introduction-to-Spatial-temporal-analysis-in-R_files/figure-html/unnamed-chunk-345-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>ガンマ分布はshape(<span class="math inline">\(a\)</span>)とscale(<span class="math inline">\(b\)</span>)の2つのパラメータによって決まるが、これらはガンマ分布の期待値<span class="math inline">\(E(X)\)</span>と分散<span class="math inline">\(var(X)\)</span>を用いて以下のように表せる。</p>
<p><span class="math display">\[
\begin{aligned}
&amp;a = E(X)^2/var(X)\\
&amp;b = a/E(X)
\end{aligned}
\]</span></p>
<p>よって、<span class="math inline">\(\tau_v\)</span>がガンマ分布に従うとしたらパラメータ<span class="math inline">\(a,b\)</span>は以下の値になる。</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="Chapter14.html#cb480-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">mean</span>(sim.tau_v)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">var</span>(sim.tau_v)</span>
<span id="cb480-2"><a href="Chapter14.html#cb480-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> a<span class="sc">/</span><span class="fu">mean</span>(sim.tau_v)</span>
<span id="cb480-3"><a href="Chapter14.html#cb480-3" tabindex="-1"></a></span>
<span id="cb480-4"><a href="Chapter14.html#cb480-4" tabindex="-1"></a><span class="fu">c</span>(a, b)</span></code></pre></div>
<pre><code>## [1] 3.9710889 0.8359842</code></pre>
<p>これらのパラメータを持つガンマ分布を実際の<span class="math inline">\(\tau_v\)</span>の分布と一緒に描くと以下のようになる。おおよそ一致していることが見て取れる。</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="Chapter14.html#cb482-1" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n =</span><span class="dv">10000</span>, <span class="at">shape =</span> a, <span class="at">scale =</span> b)</span>
<span id="cb482-2"><a href="Chapter14.html#cb482-2" tabindex="-1"></a></span>
<span id="cb482-3"><a href="Chapter14.html#cb482-3" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(sim.tau_v, gamma),</span>
<span id="cb482-4"><a href="Chapter14.html#cb482-4" tabindex="-1"></a>           <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;tau&quot;</span>,<span class="st">&quot;gamma&quot;</span>), <span class="at">each =</span> <span class="dv">10000</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb482-5"><a href="Chapter14.html#cb482-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">group =</span> type))<span class="sc">+</span></span>
<span id="cb482-6"><a href="Chapter14.html#cb482-6" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> type))<span class="sc">+</span></span>
<span id="cb482-7"><a href="Chapter14.html#cb482-7" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;dashed&quot;</span>,<span class="st">&quot;solid&quot;</span>))<span class="sc">+</span></span>
<span id="cb482-8"><a href="Chapter14.html#cb482-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb482-9"><a href="Chapter14.html#cb482-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb482-10"><a href="Chapter14.html#cb482-10" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>))</span></code></pre></div>
<p><img src="Introduction-to-Spatial-temporal-analysis-in-R_files/figure-html/unnamed-chunk-347-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="changing-the-gamma-prior-to-the-pc-prior" class="section level4 hasAnchor" number="13.2.4.2">
<h4><span class="header-section-number">13.2.4.2</span> changing the gamma prior to the PC prior<a href="Chapter14.html#changing-the-gamma-prior-to-the-pc-prior" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="citation">Simpson et al. (<a href="#ref-Simpson2014">2014</a>)</span> はPenalized Complexity (PC) 事前分布というものを導入している。この事前分布では、1つのパラメータを用いて事前分布の強弱を表現できる。例えば<span class="math inline">\(\sigma_v\)</span>のPC事前分布を考えるとき、以下の式に用いる<span class="math inline">\(U\)</span>を決める必要がある。<span class="math inline">\(\alpha\)</span>には0.05を用いる。</p>
<p><span class="math display">\[
Prob(\sigma_v &gt; U) = \alpha
\]</span></p>
<p>例えば<span class="math inline">\(U = 100\)</span>とするとき、<span class="math inline">\(\sigma_v\)</span>が100以上の大きな値をとる確率は非常に小さいということを示す。このとき、事前分布はほとんど情報を持っていない。一方で、<span class="math inline">\(U = 0.1\)</span>とするならば、<span class="math inline">\(\sigma_v\)</span>は高い確率で0から0.1までの値をとることになり、事前分布は情報があるとみなせる。</p>
<p>以下では、様々な<span class="math inline">\(U\)</span>を定めたときの<span class="math inline">\(\tau_v\)</span>の分布を描いたものである。密度の算出については <span class="citation">Simpson et al. (<a href="#ref-Simpson2014">2014</a>)</span> を参照。<span class="math inline">\(U\)</span>が大きいほど<span class="math inline">\(\sigma_v\)</span>がとりうる範囲も大きくなるので、逆に<span class="math inline">\(\tau_v\)</span>は非常に狭い分布になる。逆もしかりである。</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="Chapter14.html#cb483-1" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb483-2"><a href="Chapter14.html#cb483-2" tabindex="-1"></a>alpha  <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb483-3"><a href="Chapter14.html#cb483-3" tabindex="-1"></a>DensTau <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">100</span>, <span class="at">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb483-4"><a href="Chapter14.html#cb483-4" tabindex="-1"></a></span>
<span id="cb483-5"><a href="Chapter14.html#cb483-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb483-6"><a href="Chapter14.html#cb483-6" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="sc">-</span> <span class="fu">log</span>(alpha) <span class="sc">/</span> U[i]</span>
<span id="cb483-7"><a href="Chapter14.html#cb483-7" tabindex="-1"></a>  tau.v  <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="dv">12</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb483-8"><a href="Chapter14.html#cb483-8" tabindex="-1"></a>  DensTau[,i] <span class="ot">&lt;-</span> (lambda <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> tau.v <span class="sc">^</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>tau.v<span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.5</span>))</span>
<span id="cb483-9"><a href="Chapter14.html#cb483-9" tabindex="-1"></a>}</span>
<span id="cb483-10"><a href="Chapter14.html#cb483-10" tabindex="-1"></a></span>
<span id="cb483-11"><a href="Chapter14.html#cb483-11" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> tau.v,</span>
<span id="cb483-12"><a href="Chapter14.html#cb483-12" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">as.vector</span>(DensTau),</span>
<span id="cb483-13"><a href="Chapter14.html#cb483-13" tabindex="-1"></a>           <span class="at">U =</span> <span class="fu">rep</span>(U, <span class="at">each =</span> <span class="dv">100</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb483-14"><a href="Chapter14.html#cb483-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">U =</span> <span class="fu">str_c</span>(<span class="st">&quot;U = &quot;</span>,U)) <span class="sc">%&gt;%</span> </span>
<span id="cb483-15"><a href="Chapter14.html#cb483-15" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y))<span class="sc">+</span></span>
<span id="cb483-16"><a href="Chapter14.html#cb483-16" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb483-17"><a href="Chapter14.html#cb483-17" tabindex="-1"></a>  <span class="fu">facet_rep_wrap</span>(<span class="sc">~</span>U, <span class="at">repeat.tick.labels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb483-18"><a href="Chapter14.html#cb483-18" tabindex="-1"></a>                 <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb483-19"><a href="Chapter14.html#cb483-19" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb483-20"><a href="Chapter14.html#cb483-20" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb483-21"><a href="Chapter14.html#cb483-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Density&quot;</span>, <span class="at">x =</span> <span class="fu">expression</span>(tau[v]))</span></code></pre></div>
<p><img src="Introduction-to-Spatial-temporal-analysis-in-R_files/figure-html/unnamed-chunk-348-1.png" width="672" style="display: block; margin: auto;" />
<br/></p>
<p><code>INKA</code>では以下のようにPC事前分布を用いた分析ができる。以下では、<span class="math inline">\(U\)</span>が6つの値(<span class="math inline">\(0.01, 0.05, 0.1, 0.5, 1, 5\)</span>)をとるときそれぞれのモデルを実行している。</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="Chapter14.html#cb484-1" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb484-2"><a href="Chapter14.html#cb484-2" tabindex="-1"></a>keys <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;m14_4_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb484-3"><a href="Chapter14.html#cb484-3" tabindex="-1"></a></span>
<span id="cb484-4"><a href="Chapter14.html#cb484-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>){</span>
<span id="cb484-5"><a href="Chapter14.html#cb484-5" tabindex="-1"></a>  hyper.prec <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">theta =</span> <span class="fu">list</span>(<span class="at">prior =</span> <span class="st">&quot;pc.prec&quot;</span>,</span>
<span id="cb484-6"><a href="Chapter14.html#cb484-6" tabindex="-1"></a>                                  <span class="at">param =</span> <span class="fu">c</span>(U[[i]], <span class="fl">0.05</span>)))</span>
<span id="cb484-7"><a href="Chapter14.html#cb484-7" tabindex="-1"></a>  f14_4 <span class="ot">&lt;-</span> MigDay <span class="sc">~</span> <span class="fu">f</span>(Year,</span>
<span id="cb484-8"><a href="Chapter14.html#cb484-8" tabindex="-1"></a>                      <span class="at">model =</span> <span class="st">&quot;rw1&quot;</span>,</span>
<span id="cb484-9"><a href="Chapter14.html#cb484-9" tabindex="-1"></a>                      <span class="at">hyper =</span> hyper.prec)</span>
<span id="cb484-10"><a href="Chapter14.html#cb484-10" tabindex="-1"></a>  </span>
<span id="cb484-11"><a href="Chapter14.html#cb484-11" tabindex="-1"></a>  m14_4 <span class="ot">&lt;-</span> <span class="fu">inla</span>(f14_4,</span>
<span id="cb484-12"><a href="Chapter14.html#cb484-12" tabindex="-1"></a>                <span class="at">control.compute =</span> <span class="fu">list</span>(<span class="at">dic =</span> <span class="cn">TRUE</span>),</span>
<span id="cb484-13"><a href="Chapter14.html#cb484-13" tabindex="-1"></a>                <span class="at">control.predictor =</span> <span class="fu">list</span>(<span class="at">compute =</span> <span class="cn">TRUE</span>),</span>
<span id="cb484-14"><a href="Chapter14.html#cb484-14" tabindex="-1"></a>                <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb484-15"><a href="Chapter14.html#cb484-15" tabindex="-1"></a>                <span class="at">data =</span> salmon)</span>
<span id="cb484-16"><a href="Chapter14.html#cb484-16" tabindex="-1"></a>  </span>
<span id="cb484-17"><a href="Chapter14.html#cb484-17" tabindex="-1"></a>  <span class="fu">assign</span>(keys[i], m14_4)</span>
<span id="cb484-18"><a href="Chapter14.html#cb484-18" tabindex="-1"></a>}</span></code></pre></div>
<p><span class="math inline">\(U\)</span>の値によってモデルの予測値(<span class="math inline">\(\rm{Intercept + \mu_t}\)</span>)がどう変わるかを示したのが図<a href="Chapter14.html#fig:PCprior">13.3</a>である。<span class="math inline">\(U\)</span>の値が小さいと<span class="math inline">\(\sigma_v\)</span>も0に近い値しか取らないので、予測値がほぼ変動しないことが分かる。一方で、<span class="math inline">\(U\)</span>が一定以上大きければ結果はあまり変わらない。</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="Chapter14.html#cb485-1" tabindex="-1"></a>m14_4_1<span class="sc">$</span>summary.fitted.values <span class="sc">%&gt;%</span> </span>
<span id="cb485-2"><a href="Chapter14.html#cb485-2" tabindex="-1"></a>  <span class="fu">bind_rows</span>(m14_4_2<span class="sc">$</span>summary.fitted.values) <span class="sc">%&gt;%</span> </span>
<span id="cb485-3"><a href="Chapter14.html#cb485-3" tabindex="-1"></a>  <span class="fu">bind_rows</span>(m14_4_3<span class="sc">$</span>summary.fitted.values) <span class="sc">%&gt;%</span> </span>
<span id="cb485-4"><a href="Chapter14.html#cb485-4" tabindex="-1"></a>  <span class="fu">bind_rows</span>(m14_4_4<span class="sc">$</span>summary.fitted.values) <span class="sc">%&gt;%</span> </span>
<span id="cb485-5"><a href="Chapter14.html#cb485-5" tabindex="-1"></a>  <span class="fu">bind_rows</span>(m14_4_5<span class="sc">$</span>summary.fitted.values) <span class="sc">%&gt;%</span> </span>
<span id="cb485-6"><a href="Chapter14.html#cb485-6" tabindex="-1"></a>  <span class="fu">bind_rows</span>(m14_4_6<span class="sc">$</span>summary.fitted.values) <span class="sc">%&gt;%</span> </span>
<span id="cb485-7"><a href="Chapter14.html#cb485-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">rep</span>(salmon<span class="sc">$</span>Year, <span class="at">times =</span> <span class="dv">6</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb485-8"><a href="Chapter14.html#cb485-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">U =</span> <span class="fu">rep</span>(<span class="fu">str_c</span>(<span class="st">&quot;U = &quot;</span>, U), <span class="at">each =</span> <span class="dv">61</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb485-9"><a href="Chapter14.html#cb485-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> mean))<span class="sc">+</span></span>
<span id="cb485-10"><a href="Chapter14.html#cb485-10" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb485-11"><a href="Chapter14.html#cb485-11" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> <span class="st">`</span><span class="at">0.025quant</span><span class="st">`</span>, <span class="at">ymin =</span> <span class="st">`</span><span class="at">0.975quant</span><span class="st">`</span>),</span>
<span id="cb485-12"><a href="Chapter14.html#cb485-12" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb485-13"><a href="Chapter14.html#cb485-13" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> MigDay),</span>
<span id="cb485-14"><a href="Chapter14.html#cb485-14" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">1</span>,</span>
<span id="cb485-15"><a href="Chapter14.html#cb485-15" tabindex="-1"></a>             <span class="at">data =</span> salmon)<span class="sc">+</span></span>
<span id="cb485-16"><a href="Chapter14.html#cb485-16" tabindex="-1"></a>  <span class="fu">facet_rep_wrap</span>(<span class="sc">~</span>U, <span class="at">repeat.tick.labels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb485-17"><a href="Chapter14.html#cb485-17" tabindex="-1"></a>                 <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb485-18"><a href="Chapter14.html#cb485-18" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb485-19"><a href="Chapter14.html#cb485-19" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb485-20"><a href="Chapter14.html#cb485-20" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Migration date&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:PCprior"></span>
<img src="Introduction-to-Spatial-temporal-analysis-in-R_files/figure-html/PCprior-1.png" alt="Fitted values for the rw1 model applied on the salmon arrival dates data. A PC prior was used for the precision parameter τ v of the variance of the random walk. Each panel corresponds to a different value of U." width="768" />
<p class="caption">
図13.3: Fitted values for the rw1 model applied on the salmon arrival dates data. A PC prior was used for the precision parameter τ v of the variance of the random walk. Each panel corresponds to a different value of U.
</p>
</div>
</div>
<div id="changing-the-random-walk-model-rw2" class="section level4 hasAnchor" number="13.2.4.3">
<h4><span class="header-section-number">13.2.4.3</span> Changing the random walk model: rw2<a href="Chapter14.html#changing-the-random-walk-model-rw2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>INLA</code>にはこれまで用いてきたランダムウォークモデル<code>rw1</code>に加えてもう一つのランダムウォークモデル<code>rw2``がある。これは、以下のように書ける[^foot11]。</code>rw2`モデルではこれまで用いていたランダムモデルよりも滑らかな予測値が得られる。</p>
<p><span class="math display">\[
\begin{aligned}
&amp;(\mu_t - \mu_{t-1}) - (\mu_{t-1} - \mu_{t-2}) = v_t \\
&amp;v_t \sim N(0,\sigma^2_v)
\end{aligned}
\]</span></p>
<p>これは、<span class="math inline">\(\phi_t = \mu_t - \mu_{t-1}\)</span>と書くとき、以下のように書き換えられる。<br />
<span class="math display">\[
\begin{aligned}
&amp;\phi_t - \phi_{t-1} = v_t \\
&amp;v_t \sim N(0,\sigma^2_v)
\end{aligned}
\]</span></p>
</div>
</div>
</div>
<div id="trends-in-polar-bear-movements" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Trends in polar bear movements<a href="Chapter14.html#trends-in-polar-bear-movements" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>以下では、シロクマの自発的あるいは受動的な移動を分析した <span class="citation">(<a href="#ref-Mauritzen2003"><strong>Mauritzen2003?</strong></a>)</span> のデータを用いる。1988年から1999年の間に、86頭のオトナのメスの位置情報がテレメトリーによって記録された。テレメトリーは6日ごとに最大3年間位置情報を記録した。記録は2つの場所(スバールバル諸島とバレンツ海)で行われている。</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Blangiardo2015" class="csl-entry">
Blangiardo M, Cameletti M (2015) Spatial and spatio-temporal bayesian models with <span>R</span> - <span>INLA</span>. John Wiley &amp; Sons
</div>
<div id="ref-Carroll2015" class="csl-entry">
Carroll R, Lawson AB, Faes C, et al (2015) Comparing <span>INLA</span> and <span>OpenBUGS</span> for hierarchical poisson modeling in disease mapping. Spat Spatiotemporal Epidemiol 14-15:45–54
</div>
<div id="ref-Crozier2011" class="csl-entry">
Crozier LG, Scheuerell MD, Zabel RW (2011) Using time series analysis to characterize evolutionary and plastic responses to environmental change: A case study of a shift toward earlier migration date in sockeye salmon. Am Nat 178:755–773
</div>
<div id="ref-Durbin2012" class="csl-entry">
Durbin J, Koopman SJ (2012) Time series analysis by state space methods. OUP Oxford
</div>
<div id="ref-Ravishanker2022" class="csl-entry">
Ravishanker N, Raman B, Soyer R (2022) Dynamic time series models using <span>R-INLA</span>: An applied perspective. <a href="https://ramanbala.github.io/dynamic-time-series-models-R-INLA/" class="uri">https://ramanbala.github.io/dynamic-time-series-models-R-INLA/</a>; CRC Press
</div>
<div id="ref-Simpson2014" class="csl-entry">
Simpson DP, Rue H, Martins TG, et al (2014) Penalising model component complexity: A principled, practical approach to constructing priors. Stat Sci 32:1–28
</div>
<div id="ref-Baba2019" class="csl-entry">
馬場真哉 (2019) <span>R</span> と stan ではじめるベイズ統計モデリングによるデータ分析入門. 講談社
</div>
<div id="ref-Baba2018" class="csl-entry">
馬場真哉 (2018) 時系列分析と状態空間モデルの基礎 : <span>RとStanで学ぶ理論と実装</span>. プレアデス出版
</div>
</div>
<div class="footnotes">
<hr />
<ol start="10">
<li id="fn10"><p>基本的には、 <span class="citation">馬場 (<a href="#ref-Baba2019">2019</a>)</span> でローカルレベルモデルといわれているモデルである。<a href="Chapter14.html#fnref10" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Chapter13.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sessioninfo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
